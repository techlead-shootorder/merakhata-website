"use strict";(self.webpackChunkbedesk=self.webpackChunkbedesk||[]).push([[58],{14506:function(t,e,n){n.d(e,{V:function(){return i}});class i{constructor(t={}){this.shared=!1;for(const e in t)this[e]=t[e]}}},26979:function(t,e,n){n.d(e,{V:function(){return i}});class i{constructor(t={}){this.type="custom";for(const e in t)this[e]=t[e]}}},20082:function(t,e,n){n.d(e,{c:function(){return r}});var i=n(37716),o=n(99981);let r=(()=>{class t{constructor(t){this.http=t,this.baseUri="tags"}getTags(t){return this.http.getWithCache(this.baseUri,t)}createNew(t){return this.http.post(this.baseUri,t)}update(t,e){return this.http.put(this.baseUri+"/"+t,e)}deleteMultiple(t){return this.http.delete(this.baseUri+"/delete-multiple/"+t)}search(t,e={}){return e=Object.assign({query:t,notType:"status",perPage:10},e),this.http.get(this.baseUri,e)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o.F))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},35778:function(t,e,n){n.d(e,{U:function(){return r}});var i=n(37716),o=n(90299);let r=(()=>{class t{constructor(t){this.httpClient=t}getReplies(t){return this.httpClient.get("canned-replies",t)}create(t){return this.httpClient.post("canned-replies",t)}update(t,e){return this.httpClient.put("canned-replies/"+t,e)}delete(t){return this.httpClient.delete("canned-replies/"+t)}}return t.\u0275fac=function(e){return new(e||t)(i.LFG(o.r))},t.\u0275prov=i.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},26558:function(t,e,n){n.d(e,{w:function(){return U}});var i=n(14506),o=n(22238),r=n(9141),s=n(25917),a=n(71289),c=n(15257),d=n(37716),l=n(35778),u=n(38583),h=n(51095),p=n(76627),g=n(3679),m=n(15515),f=n(82192),b=n(48350),x=n(91241);const Z=["textEditor"];function y(t,e){1&t&&(d.TgZ(0,"span",20),d._uU(1,"Update Canned Reply"),d.qZA())}function v(t,e){1&t&&(d.TgZ(0,"span",20),d._uU(1,"New Canned Reply"),d.qZA())}function w(t,e){if(1&t&&(d.TgZ(0,"div",21),d._uU(1),d.qZA()),2&t){const t=d.oxw();d.xp6(1),d.Oqu(t.errors.name)}}function C(t,e){if(1&t&&(d.TgZ(0,"div",21),d._uU(1),d.qZA()),2&t){const t=d.oxw();d.xp6(1),d.Oqu(t.errors.shared)}}function _(t,e){if(1&t&&(d.TgZ(0,"div",21),d._uU(1),d.qZA()),2&t){const t=d.oxw();d.xp6(1),d.Oqu(t.errors.body)}}function q(t,e){if(1&t&&(d.TgZ(0,"div",21),d._uU(1),d.qZA()),2&t){const t=d.oxw();d.xp6(1),d.Oqu(t.errors.uploads)}}function A(t,e){if(1&t){const t=d.EpF();d.TgZ(0,"reply-attachment-list",22),d.NdJ("detached",function(e){return d.CHM(t),d.oxw().removeAttachment(e)}),d.qZA()}if(2&t){const t=d.oxw();d.Q6J("attachments",t.attachments)}}function M(t,e){1&t&&(d.TgZ(0,"span",20),d._uU(1,"Update"),d.qZA())}function T(t,e){1&t&&(d.TgZ(0,"span",20),d._uU(1,"Create"),d.qZA())}let U=(()=>{class t{constructor(t,e,n,o){this.dialogRef=t,this.data=e,this.cannedReplies=n,this.uploadQueue=o,this.attachments=[],this.model=new i.V,this.errors={},(0,s.of)(null).pipe((0,a.g)(0),(0,c.q)(1)).subscribe(()=>this.hydrate())}close(t){this.dialogRef.close(t),this.textEditor.destroyEditor()}confirm(){let t;const e=this.getPayload();t=this.model.id?this.cannedReplies.update(this.model.id,e):this.cannedReplies.create(e),t.subscribe(t=>{this.close(t.cannedReply)},t=>this.errors=t.errors)}getPayload(){return{name:this.model.name,body:this.textEditor.getContents(),shared:this.model.shared,uploads:this.attachments.map(t=>t.id)}}setContents(t={}){t.body&&this.textEditor.setContents(t.body),t.uploads&&(this.attachments=t.uploads.slice())}hydrate(){this.data.contents&&this.setContents(this.data.contents),this.data.cannedReply&&(this.model=new i.V(this.data.cannedReply),this.setContents({body:this.model.body,uploads:this.model.uploads}))}uploadFiles(t){this.uploadQueue.start(t).subscribe(t=>{this.attachments=[...this.attachments,t.fileEntry]})}removeAttachment(t){for(let e=0;e<this.attachments.length;e++)this.attachments[e].id===t.id&&this.attachments.splice(e,1)}}return t.\u0275fac=function(e){return new(e||t)(d.Y36(o.so),d.Y36(o.WI),d.Y36(l.U),d.Y36(r.A))},t.\u0275cmp=d.Xpm({type:t,selectors:[["crupdate-canned-reply-modal"]],viewQuery:function(t,e){if(1&t&&d.Gf(Z,7),2&t){let t;d.iGM(t=d.CRH())&&(e.textEditor=t.first)}},features:[d._Bn([r.A])],decls:37,vars:14,consts:[[1,"modal-header"],["mat-dialog-title",""],["trans","",4,"ngIf"],["type","button","mat-icon-button","","tabindex","-1",1,"close-button",3,"click"],["svgIcon","close"],["ngNativeValidate","",3,"ngSubmit"],[1,"many-inputs"],[1,"input-container"],["for","canned-reply-name","trans",""],["type","text","id","canned-reply-name","name","canned-reply-name",3,"ngModel","ngModelChange"],["class","error",4,"ngIf"],["for","shared","trans",""],["id","shared","name","shared",3,"ngModel","ngModelChange"],["trans","",3,"ngValue"],["for","canned-body","trans",""],["id","canned-body","inlineUploadPrefix","ticket_images",3,"minHeight","onFileUpload"],["textEditor",""],[3,"attachments","detached",4,"ngIf"],["mat-button","","type","button","trans","",1,"cancel-button",3,"click"],["type","submit","mat-raised-button","","color","accent",1,"submit-button"],["trans",""],[1,"error"],[3,"attachments","detached"]],template:function(t,e){1&t&&(d.TgZ(0,"div",0),d.TgZ(1,"h2",1),d.YNc(2,y,2,0,"span",2),d.YNc(3,v,2,0,"span",2),d.qZA(),d.TgZ(4,"button",3),d.NdJ("click",function(){return e.close()}),d._UZ(5,"mat-icon",4),d.qZA(),d.qZA(),d.TgZ(6,"form",5),d.NdJ("ngSubmit",function(){return e.confirm()}),d.TgZ(7,"mat-dialog-content",6),d.TgZ(8,"div",7),d.TgZ(9,"label",8),d._uU(10,"Name"),d.qZA(),d.TgZ(11,"input",9),d.NdJ("ngModelChange",function(t){return e.model.name=t}),d.qZA(),d.YNc(12,w,2,1,"div",10),d.qZA(),d.TgZ(13,"div",7),d.TgZ(14,"label",11),d._uU(15,"Shared"),d.qZA(),d.TgZ(16,"select",12),d.NdJ("ngModelChange",function(t){return e.model.shared=t}),d.TgZ(17,"option",13),d._uU(18,"Yes"),d.qZA(),d.TgZ(19,"option",13),d._uU(20,"No"),d.qZA(),d.qZA(),d.YNc(21,C,2,1,"div",10),d.qZA(),d.TgZ(22,"div",7),d.TgZ(23,"label",14),d._uU(24,"Canned Reply Body"),d.qZA(),d.TgZ(25,"text-editor",15,16),d.NdJ("onFileUpload",function(t){return e.uploadFiles(t)}),d.qZA(),d._UZ(27,"upload-progress-bar"),d.YNc(28,_,2,1,"div",10),d.YNc(29,q,2,1,"div",10),d.YNc(30,A,1,1,"reply-attachment-list",17),d.qZA(),d.qZA(),d.TgZ(31,"mat-dialog-actions"),d.TgZ(32,"button",18),d.NdJ("click",function(){return e.close()}),d._uU(33,"Cancel"),d.qZA(),d.TgZ(34,"button",19),d.YNc(35,M,2,0,"span",2),d.YNc(36,T,2,0,"span",2),d.qZA(),d.qZA(),d.qZA()),2&t&&(d.xp6(2),d.Q6J("ngIf",e.model.id),d.xp6(1),d.Q6J("ngIf",!e.model.id),d.xp6(8),d.Q6J("ngModel",e.model.name),d.xp6(1),d.Q6J("ngIf",e.errors.name),d.xp6(4),d.Q6J("ngModel",e.model.shared),d.xp6(1),d.Q6J("ngValue",!0),d.xp6(2),d.Q6J("ngValue",!1),d.xp6(2),d.Q6J("ngIf",e.errors.shared),d.xp6(4),d.Q6J("minHeight",300),d.xp6(3),d.Q6J("ngIf",e.errors.body),d.xp6(1),d.Q6J("ngIf",e.errors.uploads),d.xp6(1),d.Q6J("ngIf",e.attachments.length),d.xp6(5),d.Q6J("ngIf",e.model.id),d.xp6(1),d.Q6J("ngIf",!e.model.id))},directives:[o.uh,u.O5,h.lW,p.Hw,g.JL,g.F,o.xY,m.P,g.Fj,g.JJ,g.On,g.EJ,g.YN,g.Kr,f.d,b.o,o.H8,x.G],styles:[".crupdate-canned-reply-modal-container{width:580px}.crupdate-canned-reply-modal-container reply-attachment-list{margin-top:25px}\n"],encapsulation:2}),t})()},35866:function(t,e,n){n.d(e,{y:function(){return x}});var i=n(3679),o=n(54395),r=n(87519),s=n(43190),a=n(5304),c=n(26215),d=n(25917),l=n(37716),u=n(22238),h=n(73429),p=n(15515),g=n(76627),m=n(20616),f=n(38583);function b(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"div",9),l.NdJ("click",function(){const e=l.CHM(t).$implicit;return l.oxw().close(e)}),l._UZ(1,"img",10),l.TgZ(2,"div",11),l.TgZ(3,"div",12),l._uU(4),l.qZA(),l.TgZ(5,"div",13),l._uU(6),l.qZA(),l.qZA(),l.qZA()}if(2&t){const t=e.$implicit;l.xp6(1),l.Q6J("src",t.avatar,l.LSH),l.xp6(3),l.Oqu(t.display_name),l.xp6(2),l.Oqu(t.email)}}let x=(()=>{class t{constructor(t,e){this.dialogRef=t,this.users=e,this.searchFormControl=new i.NI,this.loading$=new c.X(!1),this.users$=new c.X([])}ngOnInit(){this.searchFormControl.valueChanges.pipe((0,o.b)(250),(0,r.x)(),(0,s.w)(t=>this.searchUsers(t)),(0,a.K)(()=>(0,d.of)([]))).subscribe(t=>{this.users$.next(t),this.loading$.next(!1)})}close(t){this.dialogRef.close(this.normalizeUser(t))}searchUsers(t){return this.loading$.next(!0),t?this.users.getAll({query:t}):(0,d.of)([])}normalizeUser(t){return t?{id:t.id,name:t.display_name,image:t.avatar,model_type:t.model_type}:null}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(u.so),l.Y36(h.Q))},t.\u0275cmp=l.Xpm({type:t,selectors:[["find-user-modal"]],decls:13,vars:7,consts:[[1,"modal-header"],["mat-dialog-title","","trans",""],["type","button","tabindex","-1",1,"no-style","close-button",3,"click"],["svgIcon","close"],[1,"input-container","search-input-container"],["type","text","placeholder","Search for user by name or email...",3,"formControl"],[1,"small",3,"isVisible"],[1,"users"],["class","user",3,"click",4,"ngFor","ngForOf"],[1,"user",3,"click"],[3,"src"],[1,"meta","overflow-hidden"],[1,"name","overflow-hidden"],[1,"email","overflow-hidden"]],template:function(t,e){1&t&&(l.TgZ(0,"div",0),l.TgZ(1,"h2",1),l._uU(2,"Find User"),l.qZA(),l.TgZ(3,"button",2),l.NdJ("click",function(){return e.close()}),l._UZ(4,"mat-icon",3),l.qZA(),l.qZA(),l.TgZ(5,"mat-dialog-content"),l.TgZ(6,"div",4),l._UZ(7,"input",5),l._UZ(8,"loading-indicator",6),l.ALo(9,"async"),l.qZA(),l.TgZ(10,"div",7),l.YNc(11,b,7,3,"div",8),l.ALo(12,"async"),l.qZA(),l.qZA()),2&t&&(l.xp6(7),l.Q6J("formControl",e.searchFormControl),l.xp6(1),l.Q6J("isVisible",l.lcZ(9,3,e.loading$)),l.xp6(3),l.Q6J("ngForOf",l.lcZ(12,5,e.users$)))},directives:[u.uh,p.P,g.Hw,u.xY,i.Fj,i.JJ,i.oH,m.Q,f.sg],pipes:[f.Ov],styles:["[_nghost-%COMP%]{display:block;width:500px;max-width:100%}.modal-header[_ngcontent-%COMP%]{margin-bottom:15px}.search-input-container[_ngcontent-%COMP%]{width:100%;margin-bottom:20px;position:relative}loading-indicator[_ngcontent-%COMP%]{top:12px;right:12px}.users[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;margin:0 -15px}.user[_ngcontent-%COMP%]{display:flex;align-items:center;width:calc(50% - 10px);flex-shrink:0;min-width:0;padding:12px;border-radius:4px;cursor:pointer}.user[_ngcontent-%COMP%]:hover{background-color:var(--be-hover)}.user[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px;flex-shrink:0;margin-right:10px;border-radius:4px;overflow:hidden}.user[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{color:var(--be-text);font-size:1.5rem;margin-bottom:5px}.user[_ngcontent-%COMP%]   .email[_ngcontent-%COMP%]{color:var(--be-secondary-text)}.overflow-hidden[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}"],changeDetection:0}),t})()},1303:function(t,e,n){n.d(e,{p:function(){return g}});var i=n(45435),o=n(36461),r=n(6966),s=n(37716),a=n(65987),c=n(19238),d=n(38583),l=n(76627);const u=["columnName"],h=["table-sort-header",""],p=["*"];let g=(()=>{class t{constructor(t,e,n,i){this.datable=t,this.cd=e,this.focusMonitor=n,this.el=i,this.orderDir=null,this.arrowVisible=!1,this.arrowDirection="down"}get sortDisabled(){var t;return null===(t=this.datable.config)||void 0===t?void 0:t.disableSort}ngOnInit(){this.orderBy||(this.orderBy=(0,r.V)(this.columnName.nativeElement.textContent,"_")),this.sortSub=this.datable.sort$.pipe((0,i.h)(t=>t.orderBy!==this.orderBy)).subscribe(()=>{this.orderDir=null,this.onMouseLeave(),this.cd.markForCheck()})}ngAfterViewInit(){this.focusMonitor.monitor(this.el).subscribe()}ngOnDestroy(){this.sortSub.unsubscribe(),this.focusMonitor.stopMonitoring(this.el)}changeSort(){this.datable.sort$.next({orderBy:this.orderBy,orderDir:this.getDirection(this.orderDir)})}getDirection(t){switch(t){case"asc":return this.arrowVisible=!1,this.orderDir=null;case"desc":return this.arrowVisible=!0,this.arrowDirection="up",this.orderDir="asc";default:return this.arrowVisible=!0,this.arrowDirection="down",this.orderDir="desc"}}onMouseEnter(){var t;(null===(t=this.datable.config)||void 0===t?void 0:t.disableSort)||(this.arrowVisible=!0)}onMouseLeave(){this.arrowVisible=!1,this.orderDir||(this.arrowDirection="down")}handleClick(){var t;(null===(t=this.datable.config)||void 0===t?void 0:t.disableSort)||this.changeSort()}handleKeydown(t){var e;!(null===(e=this.datable.config)||void 0===e?void 0:e.disableSort)&&(t.keyCode===o.L_||t.keyCode===o.K5)&&(t.preventDefault(),this.changeSort())}}return t.\u0275fac=function(e){return new(e||t)(s.Y36(a.x),s.Y36(s.sBO),s.Y36(c.tE),s.Y36(s.SBq))},t.\u0275cmp=s.Xpm({type:t,selectors:[["","table-sort-header",""]],viewQuery:function(t,e){if(1&t&&s.Gf(u,7),2&t){let t;s.iGM(t=s.CRH())&&(e.columnName=t.first)}},hostAttrs:["tabindex","0"],hostVars:4,hostBindings:function(t,e){1&t&&s.NdJ("click",function(){return e.handleClick()})("keydown",function(t){return e.handleKeydown(t)})("mouseenter",function(){return e.onMouseEnter()})("mouseleave",function(){return e.onMouseLeave()}),2&t&&s.ekj("active",e.orderDir)("sort-disabled",e.sortDisabled)},inputs:{orderBy:["table-sort-header","orderBy"]},attrs:h,ngContentSelectors:p,decls:5,vars:3,consts:[[1,"text"],["columnName",""],[1,"icon-wrapper",3,"ngClass"],["svgIcon","arrow-downward",1,"sort-icon"]],template:function(t,e){1&t&&(s.F$t(),s.TgZ(0,"span",0,1),s.Hsn(2),s.qZA(),s.TgZ(3,"span",2),s._UZ(4,"mat-icon",3),s.qZA()),2&t&&(s.xp6(3),s.Q6J("ngClass",e.arrowDirection),s.xp6(1),s.ekj("hint-visible",e.arrowVisible))},directives:[d.mk,l.Hw],styles:["[_nghost-%COMP%]{outline:none}[_nghost-%COMP%]:not(.sort-disabled){cursor:pointer}.active[_nghost-%COMP%]   .sort-icon[_ngcontent-%COMP%]{color:var(--be-text);opacity:1;transform:translate(0)}.cdk-keyboard-focused[_nghost-%COMP%]   .text[_ngcontent-%COMP%]{border-bottom:solid 1px currentColor}.text[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;text-transform:capitalize}.sort-icon[_ngcontent-%COMP%]{width:15px;height:15px;vertical-align:middle;transition:all 225ms cubic-bezier(.4,0,.2,1);transform:translateY(25%);opacity:0}.icon-wrapper[_ngcontent-%COMP%]{display:inline-block;margin-left:4px;transition:transform 225ms cubic-bezier(.4,0,.2,1)}.icon-wrapper[_ngcontent-%COMP%]:not(.down){transform:rotate(180deg)}.hint-visible[_ngcontent-%COMP%]{opacity:1;transform:translate(0)}"],changeDetection:0}),t})()}}]);