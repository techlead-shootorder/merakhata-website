!function(){"use strict";function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return e(t,n);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return e(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,a=new Array(e);n<e;n++)a[n]=t[n];return a}function n(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&a(t,e)}function a(t,e){return(a=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,a=o(t);if(e){var i=o(this).constructor;n=Reflect.construct(a,arguments,i)}else n=a.apply(this,arguments);return r(this,n)}}function r(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function c(t,e){for(var n=0;n<e.length;n++){var a=e[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function l(t,e,n){return e&&c(t.prototype,e),n&&c(t,n),t}(self.webpackChunkbedesk=self.webpackChunkbedesk||[]).push([[806],{30617:function(e,a,r){r.r(a),r.d(a,{TicketingModule:function(){return Yn}});var o=r(38583),c=r(3679),u=r(24668),d=r(83326),p=r(88002),g=r(87519),h=r(37716),m=r(87291),f=r(19244),v=r(96605),b=r(70837),x=r(93342),k=r(54395),_=r(43190),y=r(5304),Z=r(69958),w=r(68939),T=r(22238),A=r(65987),C=r(83644),q=r(45418),O=r(35866),I=r(13913),M=r(4928),U=r(15515),F=r(76627),S=r(26996),Q=r(74180),P=r(15381),J=r(64058),Y=r(1303),N=r(32141),B=r(12178),D=r(6050),E=r(58341);function R(t,e){1&t&&h._UZ(0,"mat-progress-bar",12)}function j(t,e){if(1&t&&(h.TgZ(0,"mat-chip",31),h._uU(1),h.qZA()),2&t){var n=h.oxw().$implicit;h.xp6(1),h.Oqu(n.display_name)}}function $(t,e){if(1&t&&(h.ynx(0),h.YNc(1,j,2,1,"mat-chip",30),h.BQk()),2&t){var n=e.$implicit;h.xp6(1),h.Q6J("ngIf","status"!==n.type)}}function L(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"tr",13),h.NdJ("click",function(){var t=h.CHM(n).$implicit;return h.oxw().openConversation(t)}),h._UZ(1,"td",14),h.TgZ(2,"td",15),h._uU(3),h.qZA(),h.TgZ(4,"td",16),h._UZ(5,"img",17),h.qZA(),h.TgZ(6,"td",18),h.TgZ(7,"div",19),h.TgZ(8,"mat-chip-list",20),h.YNc(9,$,2,1,"ng-container",21),h.qZA(),h.TgZ(10,"div",22),h._uU(11),h.qZA(),h.qZA(),h.TgZ(12,"div",23),h._uU(13),h.qZA(),h.qZA(),h.TgZ(14,"td",24),h.TgZ(15,"span",25),h._uU(16),h.qZA(),h.qZA(),h.TgZ(17,"td",26),h.TgZ(18,"div",27),h._uU(19),h.qZA(),h.qZA(),h.TgZ(20,"td",28),h._uU(21),h.qZA(),h.TgZ(22,"td",29),h.TgZ(23,"div",27),h._uU(24),h.qZA(),h.qZA(),h.qZA()}if(2&t){var a=e.$implicit,i=h.oxw();h.ekj("not-closed",!a.closed_at)("open","open"===a.status)("selected",i.ticketSelected(a))("fadeIn",a.animated),h.xp6(1),h.Q6J("table-body-checkbox",a.id),h.xp6(2),h.Oqu(null==a||null==a.user?null:a.user.display_name),h.xp6(2),h.s9C("src",null==a||null==a.user?null:a.user.avatar,h.LSH),h.xp6(3),h.Q6J("selectable",!1),h.xp6(1),h.Q6J("ngForOf",a.tags),h.xp6(2),h.Oqu(a.subject),h.xp6(2),h.Oqu(i.getTicketBody(a)),h.xp6(3),h.Oqu(a.replies_count||1),h.xp6(3),h.hij(" ",a.assignee?a.assignee.display_name:""," "),h.xp6(2),h.Oqu(a.id),h.xp6(3),h.Oqu(a.updated_at_formatted)}}var H,z=["*"],V=((H=function(){function t(e,n,a,i){s(this,t),this.router=e,this.modal=n,this.mailboxTags=a,this.datatable=i,this.openTicketInModal=!1,this.tickets$=this.datatable.data$}return l(t,[{key:"openConversation",value:function(t){this.openTicketInModal?this.modal.open(Q.D,{ticketId:t.id},{panelClass:"conversation-modal-container"}):this.router.navigate(["mailbox/tickets",t.id],{queryParams:{tagId:this.mailboxTags.activeTagId$.value}})}},{key:"ticketSelected",value:function(t){return this.datatable.selectedRows$.value.includes(t.id)}},{key:"getTicketBody",value:function(t){return t.latest_reply&&t.latest_reply.body?t.latest_reply.body:t.replies&&t.replies.length?t.replies[0].body:void 0}}]),t}()).\u0275fac=function(t){return new(t||H)(h.Y36(u.F0),h.Y36(P.u),h.Y36(m.N),h.Y36(A.x))},H.\u0275cmp=h.Xpm({type:H,selectors:[["tickets-list"]],inputs:{openTicketInModal:"openTicketInModal"},ngContentSelectors:z,decls:24,vars:6,consts:[["mode","indeterminate","color","accent",4,"ngIf"],[1,"table-container"],[1,"material-table","responsive-table"],["table-header-checkbox",""],["table-sort-header","user_id","trans","",1,"customer-column"],[1,"avatar-column"],["trans",""],["table-sort-header","replies_count",1,"replies-count-column"],["table-sort-header","","trans","",1,"assigned-to-column"],["table-sort-header","id","trans","",1,"number-column"],["table-sort-header","updated_at","trans","",1,"last-updated-column"],["class","animated",3,"not-closed","open","selected","fadeIn","click",4,"ngFor","ngForOf"],["mode","indeterminate","color","accent"],[1,"animated",3,"click"],[3,"table-body-checkbox"],["data-label","Customer",1,"customer-column"],[1,"avatar-column","hidden-on-mobile"],["alt","customer avatar",3,"src"],[1,"summary-column","mobile-no-label"],[1,"title"],[1,"ticket-tags",3,"selectable"],[4,"ngFor","ngForOf"],[1,"title-text","ticket-subject"],[1,"ellipses","ticket-body"],[1,"replies-count-column","hidden-on-mobile"],["title","Replies count",1,"replies-count-number"],["data-label","Assigned To",1,"assigned-to-column"],[1,"column-text-content"],["data-label","ID",1,"number-column"],["data-label","Last Updated",1,"last-updated-column"],["class","mat-compact-chip ticket-tag",4,"ngIf"],[1,"mat-compact-chip","ticket-tag"]],template:function(t,e){1&t&&(h.F$t(),h.YNc(0,R,1,0,"mat-progress-bar",0),h.ALo(1,"async"),h.TgZ(2,"div",1),h.TgZ(3,"table",2),h.TgZ(4,"thead"),h.TgZ(5,"tr"),h._UZ(6,"th",3),h.TgZ(7,"th",4),h._uU(8,"Customer"),h.qZA(),h._UZ(9,"th",5),h.TgZ(10,"th",6),h._uU(11,"Ticket Summary"),h.qZA(),h._UZ(12,"th",7),h.TgZ(13,"th",8),h._uU(14,"Assigned To"),h.qZA(),h.TgZ(15,"th",9),h._uU(16,"Number"),h.qZA(),h.TgZ(17,"th",10),h._uU(18,"Last Updated"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(19,"tbody"),h.YNc(20,L,25,19,"tr",11),h.ALo(21,"async"),h.qZA(),h.qZA(),h.Hsn(22),h._UZ(23,"datatable-footer"),h.qZA()),2&t&&(h.Q6J("ngIf",h.lcZ(1,2,e.datatable.paginator.loading$)),h.xp6(20),h.Q6J("ngForOf",h.lcZ(21,4,e.tickets$)))},directives:[o.O5,J.e,Y.p,U.P,o.sg,N.V,B.pW,D.O,E.qn,E.HS],pipes:[o.Ov],styles:["[_nghost-%COMP%]{display:block;overflow:auto;height:100%;position:relative}[_nghost-%COMP%]     .no-results-message{padding:65px 0}mat-progress-bar[_ngcontent-%COMP%]{position:absolute;top:0;left:0}.table-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;background-color:var(--be-background-alternative)}table[_ngcontent-%COMP%]{table-layout:fixed}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{height:70px;cursor:pointer}tbody[_ngcontent-%COMP%]   tr.open[_ngcontent-%COMP%]   .title-text[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr.open[_ngcontent-%COMP%]   .number-column[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr.open[_ngcontent-%COMP%]   .last-updated-column[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr.open[_ngcontent-%COMP%]   .customer-column[_ngcontent-%COMP%]{font-weight:500;color:var(--be-text)}tbody[_ngcontent-%COMP%]   tr.not-closed[_ngcontent-%COMP%]{background-color:var(--be-background)}tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background-color:var(--be-accent-emphasis)}tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover:not(.selected){background-color:var(--be-accent-emphasis)}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{height:35px;background-color:var(--be-background)}.table-checkbox[_ngcontent-%COMP%]{width:75px}.customer-column[_ngcontent-%COMP%]{width:130px;font-weight:500;color:var(--be-secondary-text)}.avatar-column[_ngcontent-%COMP%]{width:110px}.avatar-column[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:38px;height:38px;box-shadow:0 0 0 1px #fff,0 0 1px 2px #aaaeb7;border-radius:50%;margin:0 auto}.status-flag[_ngcontent-%COMP%]{width:15px;height:15px;line-height:15px;font-size:1rem;font-weight:600;text-align:center;border-radius:4px;text-transform:uppercase;color:#fff;background-color:red}.replies-count-column[_ngcontent-%COMP%]{width:50px;text-align:center}.number-column[_ngcontent-%COMP%]{width:90px;padding-right:10px}.last-updated-column[_ngcontent-%COMP%], .assigned-to-column[_ngcontent-%COMP%]{width:125px}.column-text-content[_ngcontent-%COMP%]{max-width:85%;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.replies-count-number[_ngcontent-%COMP%]{background-color:var(--be-background-alternative);color:var(--be-secondary-text);border-radius:4px;padding:1px 6px 0;font-size:1.1rem;border:1px solid var(--be-divider-default)}.summary-column[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.summary-column[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{display:flex;align-items:center}.summary-column[_ngcontent-%COMP%]   .ticket-body[_ngcontent-%COMP%]{color:var(--be-secondary-text);max-width:98%;overflow:hidden;text-overflow:ellipsis;padding-top:5px}.ticket-tags[_ngcontent-%COMP%]{margin-right:7px}.ticket-tag[_ngcontent-%COMP%]{pointer-events:none}datatable-footer[_ngcontent-%COMP%]{height:45px;background-color:var(--be-background);border-top:1px solid var(--be-divider-default);margin-top:auto}datatable-footer[_ngcontent-%COMP%]     .page-size-input{height:25px;padding-top:0;padding-bottom:0}"]}),H),G=r(35718),X=r(24688),W=r(44625),K=r(11436),tt=r(33935),et=r(4075),nt=r(63297);function at(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"button",10),h.NdJ("click",function(){var t=h.CHM(n).$implicit;return h.oxw(2).setStatusForSelectedTickets(t)}),h._uU(1),h.qZA()}if(2&t){var a=e.$implicit;h.Q6J("ngClass",a.name),h.xp6(1),h.hij(" ",a.display_name||a.name," ")}}function it(t,e){if(1&t){var n=h.EpF();h.ynx(0),h.TgZ(1,"assign-ticket-dropdown",1),h.NdJ("assigned",function(){return h.CHM(n),h.oxw().ticketsUpdated()}),h.ALo(2,"async"),h.ALo(3,"trans"),h.qZA(),h.TgZ(4,"button",2),h._UZ(5,"mat-icon",3),h.qZA(),h.TgZ(6,"mat-menu",4,5),h.YNc(8,at,2,2,"button",6),h.qZA(),h.TgZ(9,"add-tag-dropdown",7),h.NdJ("tagAdded",function(){return h.CHM(n),h.oxw().ticketsUpdated()}),h.ALo(10,"async"),h.ALo(11,"trans"),h.qZA(),h.TgZ(12,"button",8),h.NdJ("click",function(){return h.CHM(n),h.oxw().maybeDeleteSelectedTickets()}),h.ALo(13,"trans"),h._UZ(14,"mat-icon",9),h.qZA(),h.BQk()}if(2&t){var a=h.MAs(7),i=h.oxw();h.xp6(1),h.Q6J("ticketIds",h.lcZ(2,8,i.datatable.selectedRows$))("matTooltip",h.lcZ(3,10,"Assign")),h.xp6(3),h.Q6J("matMenuTriggerFor",a),h.xp6(2),h.Q6J("overlapTrigger",!1),h.xp6(2),h.Q6J("ngForOf",i.mailboxTags.statusTags),h.xp6(1),h.Q6J("ticketIds",h.lcZ(10,12,i.datatable.selectedRows$))("matTooltip",h.lcZ(11,14,"Add Tag")),h.xp6(3),h.Q6J("matTooltip",h.lcZ(13,16,"Delete"))}}var rt=function(){return["tickets.update"]},ot=function(){var t=function(){function t(e,n,a,i,r){s(this,t),this.tickets=e,this.mailboxTags=n,this.toast=a,this.currentUser=i,this.datatable=r,this.onTicketsUpdated=new h.vpe}return l(t,[{key:"noTicketsSelected",get:function(){return!this.datatable.selectedRows$.value.length}},{key:"setStatusForSelectedTickets",value:function(t){var e=this;this.tickets.changeMultipleTicketsStatus(this.datatable.selectedRows$.value,t).subscribe(function(){e.ticketsUpdated()})}},{key:"maybeDeleteSelectedTickets",value:function(){var t=this;this.datatable.confirmResourceDeletion("tickets").subscribe(function(){t.tickets.deleteMultiple(t.datatable.selectedRows$.value).subscribe(function(){t.ticketsUpdated(),t.toast.open("Tickets deleted")})})}},{key:"ticketsUpdated",value:function(){this.onTicketsUpdated.emit(),this.mailboxTags.refresh(),this.datatable.reset()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(h.Y36(Z.g),h.Y36(m.N),h.Y36(G.F),h.Y36(X.I),h.Y36(A.x))},t.\u0275cmp=h.Xpm({type:t,selectors:[["ticket-floating-toolbar"]],hostVars:2,hostBindings:function(t,e){2&t&&h.ekj("hidden",e.noTicketsSelected)},outputs:{onTicketsUpdated:"onTicketsUpdated"},decls:1,vars:2,consts:[[4,"ngIf"],[3,"ticketIds","matTooltip","assigned"],[1,"toolbar-item","no-style",3,"matMenuTriggerFor"],["svgIcon","flag-custom"],[1,"status-menu",3,"overlapTrigger"],["ticketStatusMenu","matMenu"],["mat-menu-item","",3,"ngClass","click",4,"ngFor","ngForOf"],[3,"ticketIds","matTooltip","tagAdded"],[1,"no-style","toolbar-item","delete-tickets-button","last",3,"matTooltip","click"],["svgIcon","delete-custom"],["mat-menu-item","",3,"ngClass","click"]],template:function(t,e){1&t&&h.YNc(0,it,15,18,"ng-container",0),2&t&&h.Q6J("ngIf",e.currentUser.hasPermissions(h.DdM(1,rt)))},directives:[o.O5,W.H,K.gM,tt.p6,F.Hw,tt.VK,o.sg,et.$,tt.OP,o.mk],pipes:[o.Ov,nt.R],styles:["ticket-floating-toolbar{display:flex;position:fixed;top:78px;background-color:var(--be-background);left:calc(50% - 117.5px);min-width:235px;box-shadow:0 3px 3px -2px rgba(0,0,0,.2),0 3px 4px rgba(0,0,0,.141),0 1px 8px rgba(0,0,0,.122);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:10;white-space:nowrap}ticket-floating-toolbar .toolbar-item{position:relative;cursor:pointer;transition:all .2s ease-in-out;padding:15px;border-right:1px solid var(--be-divider-default);line-height:inherit}ticket-floating-toolbar .toolbar-item.last{border-bottom:none}ticket-floating-toolbar .toolbar-item:hover{background-color:var(--be-accent-emphasis)}ticket-floating-toolbar .toolbar-item .mat-icon{color:var(--be-help-center-title-text);vertical-align:bottom;width:28px;height:28px}ticket-floating-toolbar .toolbar-item .status-tag{text-transform:capitalize}\n"],encapsulation:2}),t}(),st=r(76403);function ct(t,e){1&t&&(h.TgZ(0,"no-results-message",22),h.TgZ(1,"span",23),h._uU(2,"Nothing To Display."),h.qZA(),h.TgZ(3,"span",24),h._uU(4,"Could not find any tickets matching this search query."),h.qZA(),h.qZA())}var lt=function(t){return["/mailbox/users",t]};function ut(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"a",25),h.NdJ("click",function(){return h.CHM(n),h.oxw().close()}),h._UZ(1,"img",26),h.TgZ(2,"div",27),h.TgZ(3,"div",28),h._uU(4),h.qZA(),h.TgZ(5,"div",29),h._uU(6),h.qZA(),h.qZA(),h.qZA()}if(2&t){var a=e.$implicit;h.Q6J("routerLink",h.VKq(4,lt,a.id)),h.xp6(1),h.s9C("src",a.avatar,h.LSH),h.xp6(3),h.Oqu(a.display_name),h.xp6(2),h.Oqu(a.email)}}function dt(t,e){1&t&&(h.TgZ(0,"no-results-message",30),h.TgZ(1,"span",23),h._uU(2,"Nothing To Display."),h.qZA(),h.TgZ(3,"span",24),h._uU(4,"Could not find any users matching this search query."),h.qZA(),h.qZA())}function pt(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"a",31),h.NdJ("click",function(){return h.CHM(n),h.oxw().close()}),h._UZ(1,"mat-icon",32),h.TgZ(2,"div",33),h.TgZ(3,"div",28),h._uU(4),h.qZA(),h.TgZ(5,"div",29),h._uU(6),h.qZA(),h.qZA(),h.qZA()}if(2&t){var a=e.$implicit,i=h.oxw();h.Q6J("routerLink",i.urls.article(a)),h.xp6(4),h.Oqu(a.title),h.xp6(2),h.Oqu(a.body)}}function gt(t,e){1&t&&(h.TgZ(0,"no-results-message",34),h.TgZ(1,"span",23),h._uU(2,"Nothing To Display."),h.qZA(),h.TgZ(3,"span",24),h._uU(4,"Could not find any articles matching this search query."),h.qZA(),h.qZA())}var ht=function(){var t=function(){function t(e,n,a,i,r,o){s(this,t),this.dialogRef=e,this.data=n,this.tickets=a,this.urls=i,this.datatable=r,this.mailboxTags=o,this.filters=function(t){var e,n;return[new q.T7({description:"Date ticket was created"}),new q.yH({description:"Date ticket was last updated"}),new q.k4({key:"closed_at",label:"Closed At",description:"Date ticket was closed by customer or agent"}),new C.XQ({type:C.Bq.SelectModel,key:"assigned_to",label:"Assigned",description:"Agent ticket is currently assigned to",component:O.y}),new C.XQ({type:C.Bq.SelectModel,key:"user_id",label:"Customer",description:"Customer that created the ticket",component:O.y}),new C.XQ({type:C.Bq.Select,key:"status",description:"Current status of the ticket",defaultValue:null===(e=t.statusTags[0])||void 0===e?void 0:e.name,options:t.statusTags.map(function(t){return{key:(0,I.z)(t.display_name),value:t.name}})}),new C.XQ({type:C.Bq.Select,key:"tag",description:"Tags assigned to the ticket",defaultValue:null===(n=t.categoryTags[0])||void 0===n?void 0:n.name,options:t.categoryTags.map(function(t){return{key:(0,I.z)(t.display_name),value:t.name}})})]}({statusTags:this.mailboxTags.statusTags,categoryTags:this.mailboxTags.categoryTags}),this.results={},this.isSearching=!1,this.searchedOnce=!1,this.activeTab="tickets",this.searchQueryControl=new c.NI,this.hydrate()}return l(t,[{key:"ngOnInit",value:function(){this.datatable.paginator.dontUpdateQueryParams=!0}},{key:"ngOnDestroy",value:function(){this.datatable.destroy()}},{key:"close",value:function(){this.dialogRef.close()}},{key:"hydrate",value:function(){this.bindToSearchInput(),this.searchQueryControl.setValue(this.data.query)}},{key:"performSearch",value:function(){var t=this;this.isSearching=!0,this.tickets.search(Object.assign(Object.assign({},this.getSearchQueryParams()),{filters:this.activeFilters,query:this.activeQuery})).pipe((0,w.x)(function(){t.searchedOnce=!0,t.isSearching=!1})).subscribe(function(e){t.datatable.config?(t.datatable.paginator.response$.next({pagination:e.results.tickets}),t.datatable.config.staticParams=t.getSearchQueryParams()):t.datatable.init({uri:"search/tickets",staticParams:t.getSearchQueryParams(),initialData:e.results.tickets}),t.results=e.results})}},{key:"bindToSearchInput",value:function(){var t=this;this.searchQueryControl.valueChanges.pipe((0,k.b)(400),(0,g.x)()).subscribe(function(e){return t.activeQuery=e,t.performSearch()})}},{key:"getSearchQueryParams",value:function(){return{query:this.searchQueryControl.value,perPage:20,detailed:!0}}},{key:"onFilterChange",value:function(t){this.activeFilters=t,this.performSearch()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(h.Y36(T.so),h.Y36(T.WI),h.Y36(Z.g),h.Y36(M.X),h.Y36(A.x),h.Y36(m.N))},t.\u0275cmp=h.Xpm({type:t,selectors:[["agent-search-modal"]],features:[h._Bn([A.x])],decls:34,vars:27,consts:[[1,"modal-header"],["mat-dialog-title","","trans","",1,"modal-title"],["type","button","tabindex","-1",1,"close-button","no-style",3,"click"],["svgIcon","close"],["pluralName","tickets, articles and users",3,"searchControl","filters","filterChange"],[1,"search-results"],[1,"tab-menu"],[1,"tab-menu-item","tickets-menu-item",3,"click"],["trans",""],[1,"tab-menu-item","users-menu-item",3,"click"],[1,"tab-menu-item","articles-menu-item",3,"click"],[1,"tabs"],[1,"tab","tickets-tab"],[3,"openTicketInModal"],["svgImage","opened.svg",4,"ngIf"],[1,"tab","users-tab"],["class","user",3,"routerLink","click",4,"ngFor","ngForOf"],["svgImage","people.svg",4,"ngIf"],[1,"tab","articles-tab"],[1,"articles-list"],["class","article",3,"routerLink","click",4,"ngFor","ngForOf"],["svgImage","blog-post.svg",4,"ngIf"],["svgImage","opened.svg"],["primary-text","","trans",""],["secondary-text","","trans",""],[1,"user",3,"routerLink","click"],["alt","customer avatar",1,"avatar",3,"src"],[1,"text"],[1,"title"],[1,"body"],["svgImage","people.svg"],[1,"article",3,"routerLink","click"],["svgIcon","description"],[1,"article-info"],["svgImage","blog-post.svg"]],template:function(t,e){var n;(1&t&&(h.TgZ(0,"div",0),h.TgZ(1,"h2",1),h._uU(2,"Search"),h.qZA(),h.TgZ(3,"button",2),h.NdJ("click",function(){return e.close()}),h._UZ(4,"mat-icon",3),h.qZA(),h.qZA(),h.TgZ(5,"mat-dialog-content"),h.TgZ(6,"search-input-with-filters",4),h.NdJ("filterChange",function(t){return e.onFilterChange(t)}),h.qZA(),h.TgZ(7,"div",5),h.TgZ(8,"div",6),h.TgZ(9,"div",7),h.NdJ("click",function(){return e.activeTab="tickets"}),h._uU(10),h.ALo(11,"async"),h.TgZ(12,"span",8),h._uU(13,"Tickets"),h.qZA(),h.qZA(),h.TgZ(14,"div",9),h.NdJ("click",function(){return e.activeTab="users"}),h._uU(15),h.TgZ(16,"span",8),h._uU(17,"Users"),h.qZA(),h.qZA(),h.TgZ(18,"div",10),h.NdJ("click",function(){return e.activeTab="articles"}),h._uU(19),h.TgZ(20,"span",8),h._uU(21,"Articles"),h.qZA(),h.qZA(),h.qZA(),h.TgZ(22,"div",11),h.TgZ(23,"div",12),h.TgZ(24,"tickets-list",13),h.YNc(25,ct,5,0,"no-results-message",14),h.qZA(),h._UZ(26,"ticket-floating-toolbar"),h.qZA(),h.TgZ(27,"div",15),h.YNc(28,ut,7,6,"a",16),h.YNc(29,dt,5,0,"no-results-message",17),h.qZA(),h.TgZ(30,"div",18),h.TgZ(31,"div",19),h.YNc(32,pt,7,3,"a",20),h.YNc(33,gt,5,0,"no-results-message",21),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&t)&&(h.xp6(6),h.Q6J("searchControl",e.searchQueryControl)("filters",e.filters),h.xp6(2),h.ekj("visually-hidden",!e.searchedOnce),h.xp6(1),h.ekj("active","tickets"===e.activeTab),h.xp6(1),h.hij(" ",null==(n=h.lcZ(11,25,e.datatable.paginator.response$))||null==n.pagination?null:n.pagination.total," "),h.xp6(4),h.ekj("active","users"===e.activeTab),h.xp6(1),h.hij(" ",null==e.results.users?null:e.results.users.total," "),h.xp6(3),h.ekj("active","articles"===e.activeTab),h.xp6(1),h.hij(" ",null==e.results.articles?null:e.results.articles.total," "),h.xp6(4),h.ekj("hidden","tickets"!==e.activeTab),h.xp6(1),h.Q6J("openTicketInModal",!0),h.xp6(1),h.Q6J("ngIf",!(null!=e.results.tickets&&null!=e.results.tickets.data&&e.results.tickets.data.length||e.isSearching)),h.xp6(2),h.ekj("hidden","users"!==e.activeTab),h.xp6(1),h.Q6J("ngForOf",null==e.results.users?null:e.results.users.data),h.xp6(1),h.Q6J("ngIf",!(null!=e.results.users&&null!=e.results.users.data&&e.results.users.data.length||e.isSearching)),h.xp6(1),h.ekj("hidden","articles"!==e.activeTab),h.xp6(2),h.Q6J("ngForOf",null==e.results.articles?null:e.results.articles.data),h.xp6(1),h.Q6J("ngIf",!(null!=e.results.articles&&null!=e.results.articles.data&&e.results.articles.data.length||e.isSearching)))},directives:[T.uh,U.P,F.Hw,T.xY,S.k,V,o.O5,ot,o.sg,st.U,u.yS],pipes:[o.Ov],styles:[".agent-search-modal-container{height:100%;width:100%;max-width:none!important}.agent-search-modal-container .mat-dialog-container{border-radius:0;background-color:var(--be-background-alternative)}.agent-search-modal-container .mat-dialog-content{max-height:none;min-height:calc(100% - 54px)}.agent-search-modal-container .close-button{position:fixed;top:28px;right:38px;background-color:var(--be-background-alternative)}.agent-search-modal-container .modal-header{margin-bottom:15px}.agent-search-modal-container h2{font-size:2.4rem;font-weight:400}.agent-search-modal-container .search-results{border:1px solid var(--be-divider-default);border-radius:4px;background-color:var(--be-background);min-height:calc(100% - 75px)}.agent-search-modal-container .search-results .tab-menu{display:flex;border-bottom:1px solid var(--be-divider-default)}.agent-search-modal-container .search-results .tab-menu .tab-menu-item{padding:15px;border-bottom:2px solid transparent;cursor:pointer}.agent-search-modal-container .search-results .tab-menu .tab-menu-item.active{border-color:var(--be-accent-default)}.agent-search-modal-container .search-results .tabs{border:1px solid var(--be-divider-default);margin:15px}.agent-search-modal-container .search-results .tabs .tab{min-height:50px}.agent-search-modal-container .search-results .tabs .users-tab{padding:8px}.agent-search-modal-container .search-results .tabs .users-tab .user{display:inline-flex;width:300px;height:80px;border:1px solid var(--be-divider-default);border-radius:4px;padding:15px;margin:8px;color:var(--be-text)}.agent-search-modal-container .search-results .tabs .users-tab .user:hover{background-color:var(--be-accent-emphasis)}.agent-search-modal-container .search-results .tabs .users-tab .user img{margin-right:10px;width:50px;height:50px;-o-object-fit:cover;object-fit:cover}.agent-search-modal-container .search-results .tabs .users-tab .user .text{padding-top:6px;white-space:nowrap;overflow:hidden}.agent-search-modal-container .search-results .tabs .users-tab .user .text .title{font-size:1.5rem;overflow:hidden;text-overflow:ellipsis}.agent-search-modal-container .search-results .tabs .users-tab .user .text .body{color:var(--be-secondary-text);overflow:hidden;text-overflow:ellipsis}.agent-search-modal-container .search-results .tabs .articles-list .article{display:flex;padding:13px;border-bottom:1px solid var(--be-divider-default);color:var(--be-text)}.agent-search-modal-container .search-results .tabs .articles-list .article:last-of-type{border-bottom:none}.agent-search-modal-container .search-results .tabs .articles-list .article:hover{background-color:var(--be-accent-emphasis)}.agent-search-modal-container .search-results .tabs .articles-list .article .mat-icon{width:35px;height:35px;color:var(--be-secondary-text);margin-right:5px}.agent-search-modal-container .search-results .tabs .articles-list .article .article-info .title{font-size:1.6rem}.agent-search-modal-container .search-results .tabs .articles-list .article .article-info .body{word-wrap:break-word;color:var(--be-secondary-text)}.agent-search-modal-container .search-results .tabs tickets-list{background-color:transparent}.agent-search-modal-container .search-results no-results-message{padding:65px 0}.agent-search-modal-container search-input-with-filters{margin-bottom:25px}\n"],encapsulation:2}),t}(),mt=r(25917),ft=r(21554),vt=r(51095),bt=r(75811),xt=r(72458);function kt(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"div",16),h.NdJ("click",function(t){return h.CHM(n),h.oxw(2).setActiveCategory("tickets"),t.stopPropagation()}),h._uU(1," Conversations "),h.qZA()}if(2&t){var a=h.oxw(2);h.ekj("active","tickets"===a.activeCategory)}}function _t(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"div",17),h.NdJ("click",function(t){return h.CHM(n),h.oxw(2).setActiveCategory("users"),t.stopPropagation()}),h._uU(1," Users "),h.qZA()}if(2&t){var a=h.oxw(2);h.ekj("active","users"===a.activeCategory)}}function yt(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"div",24),h.NdJ("click",function(){h.CHM(n);var t=h.oxw().$implicit;return h.oxw(3).navigateToUser(t.user.id)}),h._uU(1),h.qZA()}if(2&t){var a=h.oxw().$implicit;h.xp6(1),h.hij(" ",a.user.display_name," ")}}function Zt(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"mat-option",20),h.NdJ("click",function(){var t=h.CHM(n).$implicit;return h.oxw(3).navigateToTicket(t.id)}),h.TgZ(1,"div",21),h._uU(2),h.qZA(),h.TgZ(3,"div",22),h._uU(4),h.qZA(),h.YNc(5,yt,2,1,"div",23),h.qZA()}if(2&t){var a=e.$implicit;h.xp6(2),h.Oqu(a.subject),h.xp6(2),h.Oqu(a.latest_reply&&a.latest_reply.body),h.xp6(1),h.Q6J("ngIf",a.user)}}function wt(t,e){if(1&t&&(h.TgZ(0,"div",18),h.YNc(1,Zt,6,3,"mat-option",19),h.qZA()),2&t){var n=h.oxw(2);h.xp6(1),h.Q6J("ngForOf",n.results.tickets.data)}}function Tt(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"mat-option",27),h.NdJ("click",function(){var t=h.CHM(n).$implicit;return h.oxw(3).navigateToUser(t.id)}),h._UZ(1,"img",28),h.TgZ(2,"div",29),h.TgZ(3,"div",21),h._uU(4),h.qZA(),h.TgZ(5,"div",22),h._uU(6),h.qZA(),h.qZA(),h.qZA()}if(2&t){var a=e.$implicit;h.xp6(1),h.s9C("src",a.avatar,h.LSH),h.xp6(3),h.Oqu(a.email),h.xp6(2),h.Oqu(a.display_name)}}function At(t,e){if(1&t&&(h.TgZ(0,"div",25),h.YNc(1,Tt,7,3,"mat-option",26),h.qZA()),2&t){var n=h.oxw(2);h.xp6(1),h.Q6J("ngForOf",n.results.users.data)}}function Ct(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"div",30),h.NdJ("click",function(){return h.CHM(n),h.oxw(2).openSearchModal()}),h.TgZ(1,"span",31),h._uU(2,"View All Results"),h.qZA(),h.qZA()}}function qt(t,e){if(1&t&&(h.TgZ(0,"div",9),h.TgZ(1,"div",10),h.YNc(2,kt,2,2,"div",11),h.YNc(3,_t,2,2,"div",12),h.qZA(),h.YNc(4,wt,2,1,"div",13),h.YNc(5,At,2,1,"div",14),h.YNc(6,Ct,3,0,"div",15),h.qZA()),2&t){var n=h.oxw();h.xp6(2),h.Q6J("ngIf",n.results.tickets.data.length),h.xp6(1),h.Q6J("ngIf",n.results.users.data.length),h.xp6(1),h.Q6J("ngIf","tickets"===n.activeCategory),h.xp6(1),h.Q6J("ngIf","users"===n.activeCategory),h.xp6(1),h.Q6J("ngIf",n.searchQuery.value)}}function Ot(t,e){1&t&&(h.TgZ(0,"div",32),h._uU(1," No tickets or users matching your search query were found. "),h.qZA())}var It={data:{tickets:{},users:{},articles:{}}},Mt=function(){var t=function(){function t(e,n,a){s(this,t),this.tickets=e,this.router=n,this.modal=a,this.searchQuery=new c.NI,this.activeCategory="tickets",this.hasResults=!1,this.loadedResultsAtLeastOnce=!1,this.isLoading=!1,this.results={tickets:{data:[]},users:{data:[]}}}return l(t,[{key:"ngOnInit",value:function(){this.bindToQueryChangeEvent()}},{key:"setActiveCategory",value:function(t){this.activeCategory=t}},{key:"navigateToTicket",value:function(t){this.reset(),this.router.navigate(["/mailbox/tickets",t])}},{key:"navigateToUser",value:function(t){this.reset(),this.router.navigate(["/mailbox/users",t])}},{key:"openSearchModal",value:function(){var t=this.searchQuery.value;this.reset(),this.modal.open(ht,{query:t},{panelClass:"agent-search-modal-container"})}},{key:"search",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?(this.isLoading=!0,this.tickets.search({query:e,perPage:10}).pipe((0,x.b)(function(e){t.hasResults=!(!e.results.tickets.total&&!e.results.users.total),t.loadedResultsAtLeastOnce=!0,t.results=e.results,t.isLoading=!1,t.setActiveCategory(e.results.tickets.total?"tickets":"users")}))):(0,mt.of)(It)}},{key:"reset",value:function(){this.searchQuery.setValue(null),this.hasResults=!1,this.results=null,this.activeCategory="tickets",this.loadedResultsAtLeastOnce=!1}},{key:"bindToQueryChangeEvent",value:function(){var t=this;this.searchQuery.valueChanges.pipe((0,k.b)(250),(0,g.x)(),(0,_.w)(function(e){return t.search(e)}),(0,y.K)(function(){return(0,mt.of)(It)})).subscribe()}}]),t}();return t.\u0275fac=function(e){return new(e||t)(h.Y36(Z.g),h.Y36(u.F0),h.Y36(P.u))},t.\u0275cmp=h.Xpm({type:t,selectors:[["ticket-search-dropdown"]],features:[h._Bn([Z.g])],decls:9,vars:4,consts:[[1,"input-container",3,"ngSubmit"],["type","text","placeholder","Search...","trans-placeholder","",1,"search-input","nav-searchbar-input",3,"matAutocomplete","formControl"],["input",""],["type","submit","mat-icon-button","",1,"search-button"],["svgIcon","search"],["customScrollbar","",1,"agent-mailbox-autocomplete"],["auto","matAutocomplete"],["class","results-container",4,"ngIf"],["class","no-results","trans","",4,"ngIf"],[1,"results-container"],[1,"header"],["class","header-item tickets-item","trans","",3,"active","click",4,"ngIf"],["class","header-item users-item","trans","",3,"active","click",4,"ngIf"],["class","results-panel tickets-panel",4,"ngIf"],["class","results-panel users-panel",4,"ngIf"],["class","footer",3,"click",4,"ngIf"],["trans","",1,"header-item","tickets-item",3,"click"],["trans","",1,"header-item","users-item",3,"click"],[1,"results-panel","tickets-panel"],["class","result",3,"click",4,"ngFor","ngForOf"],[1,"result",3,"click"],[1,"title"],[1,"body"],["class","user",3,"click",4,"ngIf"],[1,"user",3,"click"],[1,"results-panel","users-panel"],["class","result media",3,"click",4,"ngFor","ngForOf"],[1,"result","media",3,"click"],["alt","customer avatar",1,"avatar",3,"src"],[1,"text"],[1,"footer",3,"click"],["trans",""],["trans","",1,"no-results"]],template:function(t,e){if(1&t&&(h.TgZ(0,"form",0),h.NdJ("ngSubmit",function(){return e.openSearchModal()}),h._UZ(1,"input",1,2),h.TgZ(3,"button",3),h._UZ(4,"mat-icon",4),h.qZA(),h.qZA(),h.TgZ(5,"mat-autocomplete",5,6),h.YNc(7,qt,7,5,"div",7),h.YNc(8,Ot,2,0,"div",8),h.qZA()),2&t){var n=h.MAs(6);h.xp6(1),h.Q6J("matAutocomplete",n)("formControl",e.searchQuery),h.xp6(6),h.Q6J("ngIf",e.results),h.xp6(1),h.Q6J("ngIf",e.searchQuery.value&&!e.isLoading&&!e.hasResults&&e.loadedResultsAtLeastOnce)}},directives:[c._Y,c.JL,c.F,ft.ZL,c.Fj,U.P,c.JJ,c.oH,vt.lW,F.Hw,ft.XC,bt.j,o.O5,o.sg,xt.ey],styles:["ticket-search-dropdown{display:block;position:relative;max-width:700px;width:100%}ticket-search-dropdown .input-container{position:relative;height:100%}ticket-search-dropdown .input-container .search-button{position:absolute;top:2px;left:0;z-index:1}ticket-search-dropdown .input-container input{padding-left:36px}.agent-mailbox-autocomplete.mat-autocomplete-panel{max-height:750px;background-color:var(--be-background)}.agent-mailbox-autocomplete.mat-autocomplete-panel .header{display:flex;background-color:var(--be-background-alternative)}.agent-mailbox-autocomplete.mat-autocomplete-panel .header .header-item{width:50%;flex:0 0 50%;padding:12px;border-bottom:2px solid var(--be-divider-default);cursor:pointer}.agent-mailbox-autocomplete.mat-autocomplete-panel .header .header-item.active{border-color:var(--be-accent-default)}.agent-mailbox-autocomplete.mat-autocomplete-panel .no-results{font-size:1.5rem;text-align:center;width:100%;padding:10px}.agent-mailbox-autocomplete.mat-autocomplete-panel .footer{background-color:var(--be-background-alternative);text-align:center;padding:10px;cursor:pointer}.agent-mailbox-autocomplete.mat-autocomplete-panel .result{border-bottom:1px solid var(--be-divider-default);padding:10px 15px;height:auto;line-height:normal;line-height:initial;font-size:1.4rem}.agent-mailbox-autocomplete.mat-autocomplete-panel .result:hover{background-color:var(--be-background-alternative)}.agent-mailbox-autocomplete.mat-autocomplete-panel .title{font-weight:500;color:var(--be-text);overflow:hidden}.agent-mailbox-autocomplete.mat-autocomplete-panel .body{color:var(--be-secondary-text);font-size:1.3rem;word-wrap:break-word;white-space:-webkit-pre-wrap;word-break:break-all;white-space:normal}.agent-mailbox-autocomplete.mat-autocomplete-panel .user{margin-top:5px;font-size:1.25rem;font-weight:500;color:var(--be-secondary-text)}.agent-mailbox-autocomplete.mat-autocomplete-panel .media .mat-option-text{display:flex;align-items:center}.agent-mailbox-autocomplete.mat-autocomplete-panel .media .mat-option-text img{margin-right:10px;width:50px;height:50px;-o-object-fit:cover;object-fit:cover}\n"],encapsulation:2}),t}(),Ut=r(80521),Ft=r(13416),St=r(39490),Qt=r(36461),Pt=r(79765),Jt=r(22759),Yt=r(66682),Nt=r(45435),Bt=r(77393);function Dt(t){return function(e){return e.lift(new Et(t))}}var Et=function(){function t(e){s(this,t),this.value=e}return l(t,[{key:"call",value:function(t,e){return e.subscribe(new Rt(t,this.value))}}]),t}(),Rt=function(t){n(a,t);var e=i(a);function a(t,n){var i;return s(this,a),(i=e.call(this,t)).value=n,i}return l(a,[{key:"_next",value:function(t){this.destination.next(this.value)}}]),a}(Bt.L),jt=r(46782),$t=r(15257),Lt=r(39761),Ht=r(17238),zt=r(46237),Vt=r(19238),Gt=r(70946),Xt=["*"];function Wt(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"div",2),h.NdJ("click",function(){return h.CHM(n),h.oxw()._onBackdropClicked()}),h.qZA()}if(2&t){var a=h.oxw();h.ekj("mat-drawer-shown",a._isShowingBackdrop())}}function Kt(t,e){1&t&&(h.TgZ(0,"mat-drawer-content"),h.Hsn(1,2),h.qZA())}var te=[[["mat-drawer"]],[["mat-drawer-content"]],"*"],ee=["mat-drawer","mat-drawer-content","*"];function ne(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"div",2),h.NdJ("click",function(){return h.CHM(n),h.oxw()._onBackdropClicked()}),h.qZA()}if(2&t){var a=h.oxw();h.ekj("mat-drawer-shown",a._isShowingBackdrop())}}function ae(t,e){1&t&&(h.TgZ(0,"mat-sidenav-content",3),h.Hsn(1,2),h.qZA())}var ie=[[["mat-sidenav"]],[["mat-sidenav-content"]],"*"],re=["mat-sidenav","mat-sidenav-content","*"],oe=".mat-drawer-container{position:relative;z-index:1;box-sizing:border-box;-webkit-overflow-scrolling:touch;display:block;overflow:hidden}.mat-drawer-container[fullscreen]{top:0;left:0;right:0;bottom:0;position:absolute}.mat-drawer-container[fullscreen].mat-drawer-container-has-open{overflow:hidden}.mat-drawer-container.mat-drawer-container-explicit-backdrop .mat-drawer-side{z-index:3}.mat-drawer-container.ng-animate-disabled .mat-drawer-backdrop,.mat-drawer-container.ng-animate-disabled .mat-drawer-content,.ng-animate-disabled .mat-drawer-container .mat-drawer-backdrop,.ng-animate-disabled .mat-drawer-container .mat-drawer-content{transition:none}.mat-drawer-backdrop{top:0;left:0;right:0;bottom:0;position:absolute;display:block;z-index:3;visibility:hidden}.mat-drawer-backdrop.mat-drawer-shown{visibility:visible}.mat-drawer-transition .mat-drawer-backdrop{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:background-color,visibility}.cdk-high-contrast-active .mat-drawer-backdrop{opacity:.5}.mat-drawer-content{position:relative;z-index:1;display:block;height:100%;overflow:auto}.mat-drawer-transition .mat-drawer-content{transition-duration:400ms;transition-timing-function:cubic-bezier(0.25, 0.8, 0.25, 1);transition-property:transform,margin-left,margin-right}.mat-drawer{position:relative;z-index:4;display:block;position:absolute;top:0;bottom:0;z-index:3;outline:0;box-sizing:border-box;overflow-y:auto;transform:translate3d(-100%, 0, 0)}.cdk-high-contrast-active .mat-drawer,.cdk-high-contrast-active [dir=rtl] .mat-drawer.mat-drawer-end{border-right:solid 1px currentColor}.cdk-high-contrast-active [dir=rtl] .mat-drawer,.cdk-high-contrast-active .mat-drawer.mat-drawer-end{border-left:solid 1px currentColor;border-right:none}.mat-drawer.mat-drawer-side{z-index:2}.mat-drawer.mat-drawer-end{right:0;transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer{transform:translate3d(100%, 0, 0)}[dir=rtl] .mat-drawer.mat-drawer-end{left:0;right:auto;transform:translate3d(-100%, 0, 0)}.mat-drawer-inner-container{width:100%;height:100%;overflow:auto;-webkit-overflow-scrolling:touch}.mat-sidenav-fixed{position:fixed}\n",se={transformDrawer:(0,Ht.X$)("transform",[(0,Ht.SB)("open, open-instant",(0,Ht.oB)({transform:"none",visibility:"visible"})),(0,Ht.SB)("void",(0,Ht.oB)({"box-shadow":"none",visibility:"hidden"})),(0,Ht.eR)("void => open-instant",(0,Ht.jt)("0ms")),(0,Ht.eR)("void <=> open, open-instant => void",(0,Ht.jt)("400ms cubic-bezier(0.25, 0.8, 0.25, 1)"))])},ce=new h.OlP("MAT_DRAWER_DEFAULT_AUTOSIZE",{providedIn:"root",factory:function(){return!1}}),le=new h.OlP("MAT_DRAWER_CONTAINER"),ue=function(){var t=function(t){n(a,t);var e=i(a);function a(t,n,i,r,o){var c;return s(this,a),(c=e.call(this,i,r,o))._changeDetectorRef=t,c._container=n,c}return l(a,[{key:"ngAfterContentInit",value:function(){var t=this;this._container._contentMarginChanges.subscribe(function(){t._changeDetectorRef.markForCheck()})}}]),a}(Ft.PQ);return t.\u0275fac=function(e){return new(e||t)(h.Y36(h.sBO),h.Y36((0,h.Gpc)(function(){return pe})),h.Y36(h.SBq),h.Y36(Ft.mF),h.Y36(h.R0b))},t.\u0275cmp=h.Xpm({type:t,selectors:[["mat-drawer-content"]],hostAttrs:[1,"mat-drawer-content"],hostVars:4,hostBindings:function(t,e){2&t&&h.Udp("margin-left",e._container._contentMargins.left,"px")("margin-right",e._container._contentMargins.right,"px")},features:[h.qOj],ngContentSelectors:Xt,decls:1,vars:0,template:function(t,e){1&t&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),t}(),de=function(){var t=function(){function t(e,n,a,i,r,o,c){var l=this;s(this,t),this._elementRef=e,this._focusTrapFactory=n,this._focusMonitor=a,this._platform=i,this._ngZone=r,this._doc=o,this._container=c,this._elementFocusedBeforeDrawerWasOpened=null,this._enableAnimations=!1,this._position="start",this._mode="over",this._disableClose=!1,this._opened=!1,this._animationStarted=new Pt.xQ,this._animationEnd=new Pt.xQ,this._animationState="void",this.openedChange=new h.vpe(!0),this._openedStream=this.openedChange.pipe((0,Nt.h)(function(t){return t}),(0,p.U)(function(){})),this.openedStart=this._animationStarted.pipe((0,Nt.h)(function(t){return t.fromState!==t.toState&&0===t.toState.indexOf("open")}),Dt(void 0)),this._closedStream=this.openedChange.pipe((0,Nt.h)(function(t){return!t}),(0,p.U)(function(){})),this.closedStart=this._animationStarted.pipe((0,Nt.h)(function(t){return t.fromState!==t.toState&&"void"===t.toState}),Dt(void 0)),this._destroyed=new Pt.xQ,this.onPositionChanged=new h.vpe,this._modeChanged=new Pt.xQ,this.openedChange.subscribe(function(t){t?(l._doc&&(l._elementFocusedBeforeDrawerWasOpened=l._doc.activeElement),l._takeFocus()):l._isFocusWithinDrawer()&&l._restoreFocus()}),this._ngZone.runOutsideAngular(function(){(0,Jt.R)(l._elementRef.nativeElement,"keydown").pipe((0,Nt.h)(function(t){return t.keyCode===Qt.hY&&!l.disableClose&&!(0,Qt.Vb)(t)}),(0,jt.R)(l._destroyed)).subscribe(function(t){return l._ngZone.run(function(){l.close(),t.stopPropagation(),t.preventDefault()})})}),this._animationEnd.pipe((0,g.x)(function(t,e){return t.fromState===e.fromState&&t.toState===e.toState})).subscribe(function(t){var e=t.fromState,n=t.toState;(0===n.indexOf("open")&&"void"===e||"void"===n&&0===e.indexOf("open"))&&l.openedChange.emit(l._opened)})}return l(t,[{key:"position",get:function(){return this._position},set:function(t){(t="end"===t?"end":"start")!=this._position&&(this._position=t,this.onPositionChanged.emit())}},{key:"mode",get:function(){return this._mode},set:function(t){this._mode=t,this._updateFocusTrapState(),this._modeChanged.next()}},{key:"disableClose",get:function(){return this._disableClose},set:function(t){this._disableClose=(0,St.Ig)(t)}},{key:"autoFocus",get:function(){var t=this._autoFocus;return null==t?"side"!==this.mode:t},set:function(t){this._autoFocus=(0,St.Ig)(t)}},{key:"opened",get:function(){return this._opened},set:function(t){this.toggle((0,St.Ig)(t))}},{key:"_takeFocus",value:function(){var t=this;!this.autoFocus||!this._focusTrap||this._focusTrap.focusInitialElementWhenReady().then(function(e){!e&&"function"==typeof t._elementRef.nativeElement.focus&&t._elementRef.nativeElement.focus()})}},{key:"_restoreFocus",value:function(){!this.autoFocus||(this._elementFocusedBeforeDrawerWasOpened?this._focusMonitor.focusVia(this._elementFocusedBeforeDrawerWasOpened,this._openedVia):this._elementRef.nativeElement.blur(),this._elementFocusedBeforeDrawerWasOpened=null,this._openedVia=null)}},{key:"_isFocusWithinDrawer",value:function(){var t,e=null===(t=this._doc)||void 0===t?void 0:t.activeElement;return!!e&&this._elementRef.nativeElement.contains(e)}},{key:"ngAfterContentInit",value:function(){this._focusTrap=this._focusTrapFactory.create(this._elementRef.nativeElement),this._updateFocusTrapState()}},{key:"ngAfterContentChecked",value:function(){this._platform.isBrowser&&(this._enableAnimations=!0)}},{key:"ngOnDestroy",value:function(){this._focusTrap&&this._focusTrap.destroy(),this._animationStarted.complete(),this._animationEnd.complete(),this._modeChanged.complete(),this._destroyed.next(),this._destroyed.complete()}},{key:"open",value:function(t){return this.toggle(!0,t)}},{key:"close",value:function(){return this.toggle(!1)}},{key:"_closeViaBackdropClick",value:function(){return this._setOpen(!1,!0)}},{key:"toggle",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.opened,e=arguments.length>1?arguments[1]:void 0;return this._setOpen(t,!t&&this._isFocusWithinDrawer(),e)}},{key:"_setOpen",value:function(t,e){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"program";return this._opened=t,t?(this._animationState=this._enableAnimations?"open":"open-instant",this._openedVia=a):(this._animationState="void",e&&this._restoreFocus()),this._updateFocusTrapState(),new Promise(function(t){n.openedChange.pipe((0,$t.q)(1)).subscribe(function(e){return t(e?"open":"close")})})}},{key:"_getWidth",value:function(){return this._elementRef.nativeElement&&this._elementRef.nativeElement.offsetWidth||0}},{key:"_updateFocusTrapState",value:function(){this._focusTrap&&(this._focusTrap.enabled=this.opened&&"side"!==this.mode)}},{key:"_animationStartListener",value:function(t){this._animationStarted.next(t)}},{key:"_animationDoneListener",value:function(t){this._animationEnd.next(t)}}]),t}();return t.\u0275fac=function(e){return new(e||t)(h.Y36(h.SBq),h.Y36(Vt.qV),h.Y36(Vt.tE),h.Y36(Ut.t4),h.Y36(h.R0b),h.Y36(o.K0,8),h.Y36(le,8))},t.\u0275cmp=h.Xpm({type:t,selectors:[["mat-drawer"]],hostAttrs:["tabIndex","-1",1,"mat-drawer"],hostVars:12,hostBindings:function(t,e){1&t&&h.WFA("@transform.start",function(t){return e._animationStartListener(t)})("@transform.done",function(t){return e._animationDoneListener(t)}),2&t&&(h.uIk("align",null),h.d8E("@transform",e._animationState),h.ekj("mat-drawer-end","end"===e.position)("mat-drawer-over","over"===e.mode)("mat-drawer-push","push"===e.mode)("mat-drawer-side","side"===e.mode)("mat-drawer-opened",e.opened))},inputs:{position:"position",mode:"mode",disableClose:"disableClose",autoFocus:"autoFocus",opened:"opened"},outputs:{openedChange:"openedChange",_openedStream:"opened",openedStart:"openedStart",_closedStream:"closed",closedStart:"closedStart",onPositionChanged:"positionChanged"},exportAs:["matDrawer"],ngContentSelectors:Xt,decls:2,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(t,e){1&t&&(h.F$t(),h.TgZ(0,"div",0),h.Hsn(1),h.qZA())},directives:[Ft.PQ],encapsulation:2,data:{animation:[se.transformDrawer]},changeDetection:0}),t}(),pe=function(){var t=function(){function t(e,n,a,i,r){var o=this,c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],l=arguments.length>6?arguments[6]:void 0;s(this,t),this._dir=e,this._element=n,this._ngZone=a,this._changeDetectorRef=i,this._animationMode=l,this._drawers=new h.n_E,this.backdropClick=new h.vpe,this._destroyed=new Pt.xQ,this._doCheckSubject=new Pt.xQ,this._contentMargins={left:null,right:null},this._contentMarginChanges=new Pt.xQ,e&&e.change.pipe((0,jt.R)(this._destroyed)).subscribe(function(){o._validateDrawers(),o.updateContentMargins()}),r.change().pipe((0,jt.R)(this._destroyed)).subscribe(function(){return o.updateContentMargins()}),this._autosize=c}return l(t,[{key:"start",get:function(){return this._start}},{key:"end",get:function(){return this._end}},{key:"autosize",get:function(){return this._autosize},set:function(t){this._autosize=(0,St.Ig)(t)}},{key:"hasBackdrop",get:function(){return null==this._backdropOverride?!this._start||"side"!==this._start.mode||!this._end||"side"!==this._end.mode:this._backdropOverride},set:function(t){this._backdropOverride=null==t?null:(0,St.Ig)(t)}},{key:"scrollable",get:function(){return this._userContent||this._content}},{key:"ngAfterContentInit",value:function(){var t=this;this._allDrawers.changes.pipe((0,Lt.O)(this._allDrawers),(0,jt.R)(this._destroyed)).subscribe(function(e){t._drawers.reset(e.filter(function(e){return!e._container||e._container===t})),t._drawers.notifyOnChanges()}),this._drawers.changes.pipe((0,Lt.O)(null)).subscribe(function(){t._validateDrawers(),t._drawers.forEach(function(e){t._watchDrawerToggle(e),t._watchDrawerPosition(e),t._watchDrawerMode(e)}),(!t._drawers.length||t._isDrawerOpen(t._start)||t._isDrawerOpen(t._end))&&t.updateContentMargins(),t._changeDetectorRef.markForCheck()}),this._ngZone.runOutsideAngular(function(){t._doCheckSubject.pipe((0,k.b)(10),(0,jt.R)(t._destroyed)).subscribe(function(){return t.updateContentMargins()})})}},{key:"ngOnDestroy",value:function(){this._contentMarginChanges.complete(),this._doCheckSubject.complete(),this._drawers.destroy(),this._destroyed.next(),this._destroyed.complete()}},{key:"open",value:function(){this._drawers.forEach(function(t){return t.open()})}},{key:"close",value:function(){this._drawers.forEach(function(t){return t.close()})}},{key:"updateContentMargins",value:function(){var t=this,e=0,n=0;if(this._left&&this._left.opened)if("side"==this._left.mode)e+=this._left._getWidth();else if("push"==this._left.mode){var a=this._left._getWidth();e+=a,n-=a}if(this._right&&this._right.opened)if("side"==this._right.mode)n+=this._right._getWidth();else if("push"==this._right.mode){var i=this._right._getWidth();n+=i,e-=i}n=n||null,((e=e||null)!==this._contentMargins.left||n!==this._contentMargins.right)&&(this._contentMargins={left:e,right:n},this._ngZone.run(function(){return t._contentMarginChanges.next(t._contentMargins)}))}},{key:"ngDoCheck",value:function(){var t=this;this._autosize&&this._isPushed()&&this._ngZone.runOutsideAngular(function(){return t._doCheckSubject.next()})}},{key:"_watchDrawerToggle",value:function(t){var e=this;t._animationStarted.pipe((0,Nt.h)(function(t){return t.fromState!==t.toState}),(0,jt.R)(this._drawers.changes)).subscribe(function(t){"open-instant"!==t.toState&&"NoopAnimations"!==e._animationMode&&e._element.nativeElement.classList.add("mat-drawer-transition"),e.updateContentMargins(),e._changeDetectorRef.markForCheck()}),"side"!==t.mode&&t.openedChange.pipe((0,jt.R)(this._drawers.changes)).subscribe(function(){return e._setContainerClass(t.opened)})}},{key:"_watchDrawerPosition",value:function(t){var e=this;!t||t.onPositionChanged.pipe((0,jt.R)(this._drawers.changes)).subscribe(function(){e._ngZone.onMicrotaskEmpty.pipe((0,$t.q)(1)).subscribe(function(){e._validateDrawers()})})}},{key:"_watchDrawerMode",value:function(t){var e=this;t&&t._modeChanged.pipe((0,jt.R)((0,Yt.T)(this._drawers.changes,this._destroyed))).subscribe(function(){e.updateContentMargins(),e._changeDetectorRef.markForCheck()})}},{key:"_setContainerClass",value:function(t){var e=this._element.nativeElement.classList,n="mat-drawer-container-has-open";t?e.add(n):e.remove(n)}},{key:"_validateDrawers",value:function(){var t=this;this._start=this._end=null,this._drawers.forEach(function(e){"end"==e.position?t._end=e:t._start=e}),this._right=this._left=null,this._dir&&"rtl"===this._dir.value?(this._left=this._end,this._right=this._start):(this._left=this._start,this._right=this._end)}},{key:"_isPushed",value:function(){return this._isDrawerOpen(this._start)&&"over"!=this._start.mode||this._isDrawerOpen(this._end)&&"over"!=this._end.mode}},{key:"_onBackdropClicked",value:function(){this.backdropClick.emit(),this._closeModalDrawersViaBackdrop()}},{key:"_closeModalDrawersViaBackdrop",value:function(){var t=this;[this._start,this._end].filter(function(e){return e&&!e.disableClose&&t._canHaveBackdrop(e)}).forEach(function(t){return t._closeViaBackdropClick()})}},{key:"_isShowingBackdrop",value:function(){return this._isDrawerOpen(this._start)&&this._canHaveBackdrop(this._start)||this._isDrawerOpen(this._end)&&this._canHaveBackdrop(this._end)}},{key:"_canHaveBackdrop",value:function(t){return"side"!==t.mode||!!this._backdropOverride}},{key:"_isDrawerOpen",value:function(t){return null!=t&&t.opened}}]),t}();return t.\u0275fac=function(e){return new(e||t)(h.Y36(Gt.Is,8),h.Y36(h.SBq),h.Y36(h.R0b),h.Y36(h.sBO),h.Y36(Ft.rL),h.Y36(ce),h.Y36(zt.Qb,8))},t.\u0275cmp=h.Xpm({type:t,selectors:[["mat-drawer-container"]],contentQueries:function(t,e,n){var a;(1&t&&(h.Suo(n,ue,5),h.Suo(n,de,5)),2&t)&&(h.iGM(a=h.CRH())&&(e._content=a.first),h.iGM(a=h.CRH())&&(e._allDrawers=a))},viewQuery:function(t,e){var n;(1&t&&h.Gf(ue,5),2&t)&&(h.iGM(n=h.CRH())&&(e._userContent=n.first))},hostAttrs:[1,"mat-drawer-container"],hostVars:2,hostBindings:function(t,e){2&t&&h.ekj("mat-drawer-container-explicit-backdrop",e._backdropOverride)},inputs:{autosize:"autosize",hasBackdrop:"hasBackdrop"},outputs:{backdropClick:"backdropClick"},exportAs:["matDrawerContainer"],features:[h._Bn([{provide:le,useExisting:t}])],ngContentSelectors:ee,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],[4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"]],template:function(t,e){1&t&&(h.F$t(te),h.YNc(0,Wt,1,2,"div",0),h.Hsn(1),h.Hsn(2,1),h.YNc(3,Kt,2,0,"mat-drawer-content",1)),2&t&&(h.Q6J("ngIf",e.hasBackdrop),h.xp6(3),h.Q6J("ngIf",!e._content))},directives:[o.O5,ue],styles:[oe],encapsulation:2,changeDetection:0}),t}(),ge=function(){var t=function(t){n(a,t);var e=i(a);function a(t,n,i,r,o){return s(this,a),e.call(this,t,n,i,r,o)}return a}(ue);return t.\u0275fac=function(e){return new(e||t)(h.Y36(h.sBO),h.Y36((0,h.Gpc)(function(){return me})),h.Y36(h.SBq),h.Y36(Ft.mF),h.Y36(h.R0b))},t.\u0275cmp=h.Xpm({type:t,selectors:[["mat-sidenav-content"]],hostAttrs:[1,"mat-drawer-content","mat-sidenav-content"],hostVars:4,hostBindings:function(t,e){2&t&&h.Udp("margin-left",e._container._contentMargins.left,"px")("margin-right",e._container._contentMargins.right,"px")},features:[h.qOj],ngContentSelectors:Xt,decls:1,vars:0,template:function(t,e){1&t&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),t}(),he=function(){var t,e=function(t){n(a,t);var e=i(a);function a(){var t;return s(this,a),(t=e.apply(this,arguments))._fixedInViewport=!1,t._fixedTopGap=0,t._fixedBottomGap=0,t}return l(a,[{key:"fixedInViewport",get:function(){return this._fixedInViewport},set:function(t){this._fixedInViewport=(0,St.Ig)(t)}},{key:"fixedTopGap",get:function(){return this._fixedTopGap},set:function(t){this._fixedTopGap=(0,St.su)(t)}},{key:"fixedBottomGap",get:function(){return this._fixedBottomGap},set:function(t){this._fixedBottomGap=(0,St.su)(t)}}]),a}(de);return e.\u0275fac=function(n){return(t||(t=h.n5z(e)))(n||e)},e.\u0275cmp=h.Xpm({type:e,selectors:[["mat-sidenav"]],hostAttrs:["tabIndex","-1",1,"mat-drawer","mat-sidenav"],hostVars:17,hostBindings:function(t,e){2&t&&(h.uIk("align",null),h.Udp("top",e.fixedInViewport?e.fixedTopGap:null,"px")("bottom",e.fixedInViewport?e.fixedBottomGap:null,"px"),h.ekj("mat-drawer-end","end"===e.position)("mat-drawer-over","over"===e.mode)("mat-drawer-push","push"===e.mode)("mat-drawer-side","side"===e.mode)("mat-drawer-opened",e.opened)("mat-sidenav-fixed",e.fixedInViewport))},inputs:{fixedInViewport:"fixedInViewport",fixedTopGap:"fixedTopGap",fixedBottomGap:"fixedBottomGap"},exportAs:["matSidenav"],features:[h.qOj],ngContentSelectors:Xt,decls:2,vars:0,consts:[["cdkScrollable","",1,"mat-drawer-inner-container"]],template:function(t,e){1&t&&(h.F$t(),h.TgZ(0,"div",0),h.Hsn(1),h.qZA())},directives:[Ft.PQ],encapsulation:2,data:{animation:[se.transformDrawer]},changeDetection:0}),e}(),me=function(){var t,e=function(t){n(a,t);var e=i(a);function a(){return s(this,a),e.apply(this,arguments)}return a}(pe);return e.\u0275fac=function(n){return(t||(t=h.n5z(e)))(n||e)},e.\u0275cmp=h.Xpm({type:e,selectors:[["mat-sidenav-container"]],contentQueries:function(t,e,n){var a;(1&t&&(h.Suo(n,ge,5),h.Suo(n,he,5)),2&t)&&(h.iGM(a=h.CRH())&&(e._content=a.first),h.iGM(a=h.CRH())&&(e._allDrawers=a))},hostAttrs:[1,"mat-drawer-container","mat-sidenav-container"],hostVars:2,hostBindings:function(t,e){2&t&&h.ekj("mat-drawer-container-explicit-backdrop",e._backdropOverride)},exportAs:["matSidenavContainer"],features:[h._Bn([{provide:le,useExisting:e}]),h.qOj],ngContentSelectors:re,decls:4,vars:2,consts:[["class","mat-drawer-backdrop",3,"mat-drawer-shown","click",4,"ngIf"],["cdkScrollable","",4,"ngIf"],[1,"mat-drawer-backdrop",3,"click"],["cdkScrollable",""]],template:function(t,e){1&t&&(h.F$t(ie),h.YNc(0,ne,1,2,"div",0),h.Hsn(1),h.Hsn(2,1),h.YNc(3,ae,2,0,"mat-sidenav-content",1)),2&t&&(h.Q6J("ngIf",e.hasBackdrop),h.xp6(3),h.Q6J("ngIf",!e._content))},directives:[o.O5,ge,Ft.PQ],styles:[oe],encapsulation:2,changeDetection:0}),e}(),fe=function(){var t=function t(){s(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[o.ez,xt.BQ,Ut.ud,Ft.ZD],Ft.ZD,xt.BQ]}),t}(),ve=r(64833),be=function(){return["/mailbox/tickets"]},xe=function(t){return{tagId:t}};function ke(t,e){if(1&t&&(h.TgZ(0,"div",18),h.TgZ(1,"a",19),h.ALo(2,"async"),h.TgZ(3,"span",20),h._uU(4),h.ALo(5,"trans"),h.qZA(),h.TgZ(6,"span",21),h._uU(7),h.qZA(),h.qZA(),h.qZA()),2&t){var n=e.$implicit,a=h.oxw();h.Q6J("@fadeIn",void 0),h.xp6(1),h.ekj("router-link-active",h.lcZ(2,10,a.mailboxTags.activeTagId$)==n.id),h.Q6J("routerLink",h.DdM(14,be))("queryParams",h.VKq(15,xe,n.id))("ngClass",n.name),h.xp6(3),h.Oqu(h.lcZ(5,12,n.display_name)),h.xp6(2),h.ekj("hidden",!n.tickets_count),h.xp6(1),h.Oqu(n.tickets_count)}}function _e(t,e){1&t&&(h.TgZ(0,"div",24),h._UZ(1,"skeleton"),h.qZA())}var ye=function(){return[1,2,3,4]};function Ze(t,e){1&t&&(h.TgZ(0,"div",22),h.YNc(1,_e,2,0,"div",23),h.qZA()),2&t&&(h.Q6J("@fadeOut",void 0),h.xp6(1),h.Q6J("ngForOf",h.DdM(2,ye)))}function we(t,e){if(1&t&&(h.TgZ(0,"div",25),h.TgZ(1,"a",26),h.ALo(2,"async"),h.TgZ(3,"span",20),h._uU(4),h.qZA(),h.TgZ(5,"span",21),h._uU(6),h.qZA(),h.qZA(),h.qZA()),2&t){var n=e.$implicit,a=h.oxw();h.Q6J("@fadeIn",void 0),h.xp6(1),h.ekj("router-link-active",h.lcZ(2,9,a.mailboxTags.activeTagId$)==n.id),h.Q6J("routerLink",h.DdM(11,be))("queryParams",h.VKq(12,xe,n.id)),h.xp6(3),h.Oqu(n.display_name),h.xp6(1),h.ekj("hidden",!n.tickets_count),h.xp6(1),h.Oqu(n.tickets_count)}}function Te(t,e){1&t&&(h.TgZ(0,"div",24),h._UZ(1,"skeleton"),h.qZA())}function Ae(t,e){1&t&&(h.TgZ(0,"div",22),h.YNc(1,Te,2,0,"div",23),h.qZA()),2&t&&(h.Q6J("@fadeOut",void 0),h.xp6(1),h.Q6J("ngForOf",h.DdM(2,ye)))}var Ce=function(){var t=function(){function t(e,n,a,i){s(this,t),this.mailboxTags=e,this.route=n,this.i18n=a,this.breakpoints=i,this.leftColumnIsHidden=!1,this.trackByFn=function(t,e){return e.id}}return l(t,[{key:"ngOnInit",value:function(){var t=this;this.leftColumnIsHidden=this.breakpoints.isMobile$.value,this.route.queryParams.pipe((0,p.U)(function(t){return t.tagId}),(0,g.x)()).subscribe(function(e){t.mailboxTags.setActiveTag(e)})}},{key:"toggleLeftSidebar",value:function(){this.leftColumnIsHidden=!this.leftColumnIsHidden}}]),t}();return t.\u0275fac=function(e){return new(e||t)(h.Y36(m.N),h.Y36(u.gz),h.Y36(f.Z),h.Y36(v.S))},t.\u0275cmp=h.Xpm({type:t,selectors:[["mailbox"]],decls:31,vars:25,consts:[["menuPosition","agent-mailbox","color","accent",1,"box-shadow",3,"showToggleButton","hideToggleBtnOnDesktop","toggleButtonClick"],[1,"nav-searchbar"],[1,"mailbox-container"],[1,"left-column",3,"opened","mode","fixedInViewport","fixedTopGap"],[1,"aside-container","status-tags"],[1,"aside-container-title"],["svgIcon","inbox-custom",1,"title-icon"],["trans","",1,"aside-container-name"],[1,"aside-container-body"],["class","status-tag",4,"ngFor","ngForOf","ngForTrackBy"],["class","skeletons-container",4,"ngIf"],[1,"aside-container","category-tags"],["svgIcon","box-filled-custom",1,"title-icon"],["class","category-tag",4,"ngFor","ngForOf","ngForTrackBy"],[1,"bottom-action-container"],["mat-icon-button","","routerLink","/mailbox/tickets/new",3,"matTooltip"],["svgIcon","new-ticket-custom"],[1,"right-column"],[1,"status-tag"],[1,"aside-nav-item",3,"routerLink","queryParams","ngClass"],[1,"tag-name"],[1,"label","tickets-count"],[1,"skeletons-container"],["class","aside-nav-item",4,"ngFor","ngForOf"],[1,"aside-nav-item"],[1,"category-tag"],[1,"aside-nav-item",3,"routerLink","queryParams"]],template:function(t,e){1&t&&(h.TgZ(0,"material-navbar",0),h.NdJ("toggleButtonClick",function(){return e.toggleLeftSidebar()}),h._UZ(1,"ticket-search-dropdown",1),h.qZA(),h.TgZ(2,"mat-sidenav-container",2),h.TgZ(3,"mat-sidenav",3),h.ALo(4,"async"),h.TgZ(5,"section",4),h.TgZ(6,"div",5),h._UZ(7,"mat-icon",6),h.TgZ(8,"span",7),h._uU(9,"Inbox"),h.qZA(),h.qZA(),h.TgZ(10,"div",8),h.YNc(11,ke,8,17,"div",9),h.YNc(12,Ze,2,3,"div",10),h.ALo(13,"async"),h.ALo(14,"async"),h.qZA(),h.qZA(),h.TgZ(15,"section",11),h.TgZ(16,"div",5),h._UZ(17,"mat-icon",12),h.TgZ(18,"span",7),h._uU(19,"Folders"),h.qZA(),h.qZA(),h.TgZ(20,"div",8),h.YNc(21,we,7,14,"div",13),h.YNc(22,Ae,2,3,"div",10),h.ALo(23,"async"),h.ALo(24,"async"),h.qZA(),h.qZA(),h.TgZ(25,"div",14),h.TgZ(26,"a",15),h.ALo(27,"trans"),h._UZ(28,"mat-icon",16),h.qZA(),h.qZA(),h.qZA(),h.TgZ(29,"mat-sidenav-content",17),h._UZ(30,"router-outlet"),h.qZA(),h.qZA()),2&t&&(h.Q6J("showToggleButton",!0)("hideToggleBtnOnDesktop",!0),h.xp6(3),h.Q6J("opened",!e.leftColumnIsHidden)("mode",h.lcZ(4,13,e.breakpoints.isMobile$)?"over":"side")("fixedInViewport",!0)("fixedTopGap",70),h.xp6(8),h.Q6J("ngForOf",e.mailboxTags.viewTags)("ngForTrackBy",e.trackByFn),h.xp6(1),h.Q6J("ngIf",!h.lcZ(13,15,e.mailboxTags.allTags$).length&&h.lcZ(14,17,e.mailboxTags.loading$)),h.xp6(9),h.Q6J("ngForOf",e.mailboxTags.categoryTags)("ngForTrackBy",e.trackByFn),h.xp6(1),h.Q6J("ngIf",!h.lcZ(23,19,e.mailboxTags.allTags$).length&&h.lcZ(24,21,e.mailboxTags.loading$)),h.xp6(4),h.Q6J("matTooltip",h.lcZ(27,23,"Create new ticket")))},directives:[b.e,Mt,me,he,F.Hw,U.P,o.sg,o.O5,vt.zs,u.yS,K.gM,ge,u.lC,o.mk,ve._],pipes:[o.Ov,nt.R],styles:["[_nghost-%COMP%]{display:block;position:relative;max-height:100vh;overflow:hidden}material-navbar[_ngcontent-%COMP%]{height:70px}.left-column[_ngcontent-%COMP%]{width:225px;background-color:var(--be-background-alternative);border-right:1px solid var(--be-divider-default)}.aside-container[_ngcontent-%COMP%]{list-style:none;padding-left:0}skeleton[_ngcontent-%COMP%]{max-width:77%}.aside-container-body[_ngcontent-%COMP%]{position:relative;min-height:160px}.skeletons-container[_ngcontent-%COMP%]{position:absolute;top:0;width:100%}.aside-container-title[_ngcontent-%COMP%]{position:relative;padding:20px 15px 15px;text-transform:uppercase;letter-spacing:.03em;color:var(--be-secondary-text);font-weight:500;white-space:nowrap;overflow:hidden}.aside-container-title[_ngcontent-%COMP%]   .title-icon[_ngcontent-%COMP%]{position:absolute;top:17px}.aside-container-title[_ngcontent-%COMP%]   .aside-container-name[_ngcontent-%COMP%]{padding-left:30px}.aside-nav-item[_ngcontent-%COMP%]{display:block;position:relative;padding:10px 0 10px 41px;cursor:pointer;clear:both;text-transform:capitalize;color:#858b94;text-decoration:none;width:100%;border-left:3px solid transparent}.aside-nav-item[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:1.1rem;text-transform:none;position:absolute;top:12px;right:5px;border-radius:20px;padding:1px 10px;line-height:15px}.aside-nav-item[_ngcontent-%COMP%]   .tag-name[_ngcontent-%COMP%]{display:block;max-width:80%;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.aside-nav-item.router-link-active[_ngcontent-%COMP%]{background-color:var(--be-accent-emphasis);border-left-color:var(--be-accent-default)}.aside-nav-item.router-link-active[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{background-color:var(--be-accent-default);color:var(--be-accent-contrast)}.aside-nav-item[_ngcontent-%COMP%]:hover{background-color:var(--be-hover)}.be-dark-mode[_nghost-%COMP%]   .aside-nav-item[_ngcontent-%COMP%], .be-dark-mode   [_nghost-%COMP%]   .aside-nav-item[_ngcontent-%COMP%]{color:var(--be-secondary-text)}.right-column[_ngcontent-%COMP%]{background-color:var(--be-background)}conversation[_ngcontent-%COMP%]{margin-bottom:15px}.bottom-action-container[_ngcontent-%COMP%]{position:absolute;bottom:5px;left:5px;color:var(--be-secondary-text)}"],data:{animation:d.B}}),t}(),qe=r(3093);function Oe(t,e){1&t&&(h.TgZ(0,"no-results-message",1),h.TgZ(1,"span",2),h._uU(2,"There are no tickets in this category yet."),h.qZA(),h.qZA())}var Ie=function(){var e=function(){function e(t,n,a,i,r,o){s(this,e),this.mailboxTags=t,this.router=n,this.modal=a,this.route=i,this.backendEvents=r,this.datatable=o,this.datatable.paginator.perPageCacheKey="agent-ticket-list-per-page"}return l(e,[{key:"ngOnInit",value:function(){var t=this;this.datatable.init({uri:"tickets",staticParams:{tagId:this.mailboxTags.activeTagId$.value}}),this.mailboxSub=this.mailboxTags.activeTagId$.pipe((0,g.x)()).subscribe(function(e){t.datatable.reset({tagId:e})}),this.bindToBackendEvents()}},{key:"ngOnDestroy",value:function(){this.datatable.destroy(),this.mailboxSub.unsubscribe()}},{key:"bindToBackendEvents",value:function(){var e=this;this.backendEvents.ticketCreated.subscribe(function(n){!n.tags||!n.tags.find(function(t){return t.id===e.mailboxTags.activeTagId$.value})||e.datatable.data.find(function(t){return t.id===n.id})||(n.animated=!0,e.datatable.data=[n].concat(t(e.datatable.data)),e.mailboxTags.refresh())})}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(m.N),h.Y36(u.F0),h.Y36(P.u),h.Y36(u.gz),h.Y36(qe.O),h.Y36(A.x))},e.\u0275cmp=h.Xpm({type:e,selectors:[["agent-mailbox-ticket-list"]],features:[h._Bn([A.x])],decls:4,vars:3,consts:[["svgImage","opened.svg",4,"ngIf"],["svgImage","opened.svg"],["primary-text","","trans",""]],template:function(t,e){1&t&&(h.TgZ(0,"tickets-list"),h.YNc(1,Oe,3,0,"no-results-message",0),h.ALo(2,"async"),h.qZA(),h._UZ(3,"ticket-floating-toolbar")),2&t&&(h.xp6(1),h.Q6J("ngIf",h.lcZ(2,1,e.datatable.paginator.noResults$)))},directives:[V,o.O5,ot,st.U,U.P],pipes:[o.Ov],styles:["agent-mailbox-ticket-list{display:block;height:calc(100vh - 70px)}\n"],encapsulation:2}),e}(),Me=r(61),Ue=r(20964),Fe=r(34060),Se=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(var n in s(this,t),e)this[n]=e[n]},Qe=r(73429);function Pe(t,e){if(1&t&&(h.TgZ(0,"div",11),h._uU(1),h.qZA()),2&t){var n=h.oxw();h.xp6(1),h.Oqu(n.errors["emails.0"])}}var Je=function(){var t=function(){function t(e,n,a){s(this,t),this.dialogRef=e,this.data=n,this.users=a,this.errors={}}return l(t,[{key:"close",value:function(t){this.dialogRef.close(t)}},{key:"confirm",value:function(){var t=this;this.users.addEmail(this.data.userId,{emails:[this.emailAddress]}).subscribe(function(){t.close(t.emailAddress)},function(e){return t.errors=e.errors})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(h.Y36(T.so),h.Y36(T.WI),h.Y36(Qe.Q))},t.\u0275cmp=h.Xpm({type:t,selectors:[["email-address-modal"]],decls:15,vars:2,consts:[[1,"modal-header"],["mat-dialog-title","","trans",""],["type","button","mat-icon-button","","tabindex","-1",1,"close-button",3,"click"],["svgIcon","close"],["ngNativeValidate","","mat-dialog-content","",3,"ngSubmit"],[1,"input-container"],["for","email"],["type","email","name","email","id","email","required","",3,"ngModel","ngModelChange"],["class","error",4,"ngIf"],["type","button","mat-button","","trans","",1,"cancel-button",3,"click"],["type","submit","mat-raised-button","","color","accent","trans","",1,"submit-button"],[1,"error"]],template:function(t,e){1&t&&(h.TgZ(0,"div",0),h.TgZ(1,"h2",1),h._uU(2,"Enter Email Address"),h.qZA(),h.TgZ(3,"button",2),h.NdJ("click",function(){return e.close()}),h._UZ(4,"mat-icon",3),h.qZA(),h.qZA(),h.TgZ(5,"form",4),h.NdJ("ngSubmit",function(){return e.confirm()}),h.TgZ(6,"div",5),h._UZ(7,"label",6),h.TgZ(8,"input",7),h.NdJ("ngModelChange",function(t){return e.emailAddress=t}),h.qZA(),h.YNc(9,Pe,2,1,"div",8),h.qZA(),h.TgZ(10,"mat-dialog-actions"),h.TgZ(11,"button",9),h.NdJ("click",function(){return e.close()}),h._uU(12,"Cancel"),h.qZA(),h.TgZ(13,"button",10),h._uU(14,"Confirm"),h.qZA(),h.qZA(),h.qZA()),2&t&&(h.xp6(8),h.Q6J("ngModel",e.emailAddress),h.xp6(1),h.Q6J("ngIf",e.errors["emails.0"]))},directives:[T.uh,U.P,vt.lW,F.Hw,c.JL,c.F,T.xY,c.Fj,c.Q7,c.JJ,c.On,o.O5,T.H8],styles:["[_nghost-%COMP%]{display:block;width:400px;max-width:100%}"]}),t}(),Ye=r(56313),Ne=r(53534),Be=r(26215),De=r(13880),Ee=r(81378),Re=r(34673),je=r(42099),$e=r(65939),Le=r(9489),He=r(36749);function ze(t,e){if(1&t&&h._UZ(0,"mat-icon",36),2&t){h.oxw();var n=h.MAs(12);h.Q6J("matMenuTriggerFor",n)}}function Ve(t,e){if(1&t&&(h.TgZ(0,"div",19),h.TgZ(1,"div",16),h._uU(2,"Envato"),h.qZA(),h.TgZ(3,"div",37),h._uU(4),h.qZA(),h.qZA()),2&t){var n=h.oxw();h.xp6(4),h.Oqu(n.user.purchase_codes[0].envato_username)}}function Ge(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"button",40),h.NdJ("click",function(){h.CHM(n);var t=h.oxw().$implicit;return h.oxw().removeEmail(t.address)}),h._UZ(1,"mat-icon",41),h.qZA()}}function Xe(t,e){if(1&t&&(h.TgZ(0,"div",38),h.YNc(1,Ge,2,0,"button",39),h.TgZ(2,"span"),h._uU(3),h.qZA(),h.qZA()),2&t){var n=e.$implicit,a=h.oxw();h.xp6(1),h.Q6J("ngIf",a.detailsEditable),h.xp6(2),h.Oqu(n.address)}}function We(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"div",19),h.TgZ(1,"button",42),h.NdJ("click",function(){return h.CHM(n),h.oxw().openAddEmailModal()}),h._uU(2,"Add Email"),h.qZA(),h.qZA()}}var Ke=function(){var t=function(){function t(e,n,a,i,r,o,l,u,d){s(this,t),this.users=e,this.route=n,this.toast=a,this.modal=i,this.avatarValidator=r,this.currentUser=o,this.settings=l,this.reports=u,this.datatable=d,this.user=new Fe.n({purchase_codes:[]}),this.detailsEditable=!1,this.userSearches$=new Be.X(null),this.profile=new c.cw({details:new c.NI,notes:new c.NI}),this.tagsControl=new c.NI([])}return l(t,[{key:"ngOnInit",value:function(){var t=this;this.route.data.subscribe(function(e){t.hydrateProfile(e.user),t.bindFormControls(),t.createDataSource()}),this.detailsEditable=this.currentUser.hasPermission("users.update")}},{key:"openAddEmailModal",value:function(){var t=this;this.modal.show(Je,{userId:this.user.id}).afterClosed().subscribe(function(e){t.user.secondary_emails.push(new Se({address:e}))})}},{key:"removeEmail",value:function(t){var e=this;this.users.removeEmail(this.user.id,{emails:[t]}).subscribe(function(){var n=e.user.secondary_emails.findIndex(function(e){return e.address===t});e.user.secondary_emails.splice(n,1)})}},{key:"openAvatarUploadDialog",value:function(){var t=this;(0,Ye.r)({types:[Ne.j.image]}).then(function(e){t.avatarValidator.validateWithToast(e[0]).failed||t.users.uploadAvatar(t.user.id,e).subscribe(function(e){t.user.avatar=e.user.avatar,t.currentUser.set("avatar",e.user.avatar),t.toast.open("Avatar updated")},function(e){var n=Object.keys(e.errors)[0];t.toast.open(e.errors[n])})})}},{key:"deleteAvatar",value:function(){var t=this;this.users.deleteAvatar(this.user.id).subscribe(function(e){t.user.avatar=e.avatar,t.toast.open("Avatar removed.")})}},{key:"hydrateProfile",value:function(t){this.user=t,t.details&&this.profile.setValue({details:t.details.details,notes:t.details.notes}),this.tagsControl.setValue(t.tags.map(function(t){return t.name}))}},{key:"createDataSource",value:function(){this.datatable.paginator.dontUpdateQueryParams=!0,this.datatable.init({uri:"tickets",staticParams:{userId:this.user.id}})}},{key:"bindFormControls",value:function(){var t=this;this.profile.valueChanges.pipe((0,k.b)(600),(0,g.x)()).subscribe(function(e){t.users.updateDetails(t.user.id,e).subscribe(function(){t.toast.open("Updated user details.")})}),this.tagsControl.valueChanges.subscribe(function(e){t.users.syncTags(t.user.id,{tags:e}).subscribe()})}},{key:"tabChanged",value:function(t){var e=this;1===t.index&&!this.userSearches$.value&&this.reports.getUserSearchesReport(this.user.id).subscribe(function(t){e.userSearches$.next(t.report)})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(h.Y36(Qe.Q),h.Y36(u.gz),h.Y36(G.F),h.Y36(P.u),h.Y36(Ee.m),h.Y36(X.I),h.Y36(Re.Z),h.Y36(je.F),h.Y36(A.x))},t.\u0275cmp=h.Xpm({type:t,selectors:[["user-profile"]],viewQuery:function(t,e){var n;(1&t&&h.Gf(De.s,7),2&t)&&(h.iGM(n=h.CRH())&&(e.tagsManager=n.first))},features:[h._Bn([A.x])],decls:66,vars:28,consts:[["menuPosition","agent-mailbox"],[1,"nav-searchbar"],[1,"content"],["customScrollbar","lite",1,"sidebar"],[1,"panel"],[1,"panel-body"],[1,"user-info"],[1,"avatar-container"],["alt","user avatar",1,"user-avatar",3,"src"],[1,"hover-overlay"],["svgIcon","edit",3,"matMenuTriggerFor",4,"ngIf"],[1,"update-avatar-menu"],["updateAvatarMenu","matMenu"],["mat-menu-item","","trans","",1,"upload-avatar-item",3,"click"],["mat-menu-item","","trans","",1,"delete-avatar-item",3,"click"],[1,"names"],[1,"name"],[1,"email","primary-email"],[1,"user-details"],[1,"details-row"],["trans","",1,"name"],[1,"input-container","value"],["name","details","id","details",3,"formControl","readonly"],["name","notes","id","notes",3,"formControl","readonly"],["class","details-row",4,"ngIf"],[1,"emails","value"],["class","email secondary-email",4,"ngFor","ngForOf"],["trans","",1,"panel-header"],[3,"formControl","readonly"],["color","accent",3,"selectedTabChange"],[3,"label"],[1,"tickets"],[3,"openTicketInModal"],["primary-text","","trans",""],[3,"data"],["trans",""],["svgIcon","edit",3,"matMenuTriggerFor"],[1,"value"],[1,"email","secondary-email"],["class","remove-email-button","mat-icon-button","",3,"click",4,"ngIf"],["mat-icon-button","",1,"remove-email-button",3,"click"],["svgIcon","close"],["mat-flat-button","","color","accent","trans","",1,"add-email-button",3,"click"]],template:function(t,e){1&t&&(h.TgZ(0,"material-navbar",0),h._UZ(1,"ticket-search-dropdown",1),h.qZA(),h.TgZ(2,"div",2),h.TgZ(3,"aside",3),h.TgZ(4,"div",4),h.TgZ(5,"div",5),h.TgZ(6,"div",6),h.TgZ(7,"div",7),h._UZ(8,"img",8),h.TgZ(9,"div",9),h.YNc(10,ze,1,1,"mat-icon",10),h.qZA(),h.qZA(),h.TgZ(11,"mat-menu",11,12),h.TgZ(13,"button",13),h.NdJ("click",function(){return e.openAvatarUploadDialog()}),h._uU(14,"Upload"),h.qZA(),h.TgZ(15,"button",14),h.NdJ("click",function(){return e.deleteAvatar()}),h._uU(16,"Remove"),h.qZA(),h.qZA(),h.TgZ(17,"div",15),h.TgZ(18,"div",16),h._uU(19),h.qZA(),h.TgZ(20,"div",17),h._uU(21),h.qZA(),h.qZA(),h.qZA(),h.TgZ(22,"div",18),h.TgZ(23,"div",19),h.TgZ(24,"div",20),h._uU(25,"Details"),h.qZA(),h.TgZ(26,"div",21),h._UZ(27,"textarea",22),h.qZA(),h.qZA(),h.TgZ(28,"div",19),h.TgZ(29,"div",20),h._uU(30,"Notes"),h.qZA(),h.TgZ(31,"div",21),h._UZ(32,"textarea",23),h.qZA(),h.qZA(),h.YNc(33,Ve,5,1,"div",24),h.TgZ(34,"div",19),h.TgZ(35,"div",20),h._uU(36,"Emails"),h.qZA(),h.TgZ(37,"div",25),h.TgZ(38,"div",17),h._uU(39),h.qZA(),h.YNc(40,Xe,4,2,"div",26),h.qZA(),h.qZA(),h.YNc(41,We,3,0,"div",24),h.qZA(),h.qZA(),h.qZA(),h.TgZ(42,"div",4),h.TgZ(43,"div",27),h._uU(44,"Tags"),h.qZA(),h.TgZ(45,"div",5),h._UZ(46,"tags-manager",28),h.qZA(),h.qZA(),h.qZA(),h.TgZ(47,"mat-tab-group",29),h.NdJ("selectedTabChange",function(t){return e.tabChanged(t)}),h.TgZ(48,"mat-tab",30),h.ALo(49,"trans"),h.TgZ(50,"div",31),h.TgZ(51,"tickets-list",32),h.TgZ(52,"no-results-message"),h.ALo(53,"async"),h.TgZ(54,"span",33),h._uU(55,"This user did not create any tickets yet."),h.qZA(),h.qZA(),h.qZA(),h._UZ(56,"ticket-floating-toolbar"),h.qZA(),h.qZA(),h.TgZ(57,"mat-tab",30),h.ALo(58,"trans"),h.TgZ(59,"search-report-table",34),h.ALo(60,"async"),h.TgZ(61,"span",35),h._uU(62,"Search Term"),h.qZA(),h.TgZ(63,"info-popover"),h.TgZ(64,"span",35),h._uU(65,"This report shows what this user searched for recently."),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&t&&(h.xp6(8),h.s9C("src",e.user.avatar,h.LSH),h.xp6(2),h.Q6J("ngIf",e.detailsEditable),h.xp6(9),h.Oqu(e.user.display_name),h.xp6(2),h.Oqu(e.user.email),h.xp6(6),h.Q6J("formControl",e.profile.controls.details)("readonly",!e.detailsEditable),h.xp6(5),h.Q6J("formControl",e.profile.controls.notes)("readonly",!e.detailsEditable),h.xp6(1),h.Q6J("ngIf",e.user.purchase_codes&&(null==e.user.purchase_codes[0]?null:e.user.purchase_codes[0].envato_username)),h.xp6(6),h.Oqu(e.user.email),h.xp6(1),h.Q6J("ngForOf",e.user.secondary_emails),h.xp6(1),h.Q6J("ngIf",e.detailsEditable),h.xp6(5),h.Q6J("formControl",e.tagsControl)("readonly",!e.detailsEditable),h.xp6(2),h.Q6J("label",h.lcZ(49,20,"Tickets")),h.xp6(3),h.Q6J("openTicketInModal",!0),h.xp6(1),h.ekj("hidden",!h.lcZ(53,22,e.datatable.paginator.noResults$)),h.xp6(5),h.Q6J("label",h.lcZ(58,24,"Searches")),h.xp6(2),h.Q6J("data",h.lcZ(60,26,e.userSearches$)))},directives:[b.e,Mt,bt.j,o.O5,tt.VK,tt.OP,U.P,c.Fj,c.JJ,c.oH,o.sg,De.s,$e.SP,$e.uX,V,st.U,ot,Le.K,He.N,F.Hw,tt.p6,vt.lW],pipes:[nt.R,o.Ov],styles:["user-profile{display:block;width:100%;height:100%;background-color:var(--be-background-alternative)}user-profile .content{display:flex;padding:25px;width:100%;height:calc(100vh - 70px);overflow:hidden}user-profile .sidebar{flex:0 0 320px;width:320px;margin-right:15px;height:100%;overflow:auto}user-profile .sidebar .panel{margin-bottom:15px;background-color:var(--be-background);border:1px solid var(--be-divider-default);padding:10px}user-profile .sidebar .panel .panel-header{padding:5px}user-profile .sidebar .user-info{display:flex;align-items:center;border-bottom:1px solid var(--be-divider-default);margin-bottom:15px;padding-bottom:15px}user-profile .sidebar .user-info .avatar-container{width:65px;height:65px;position:relative}user-profile .sidebar .user-info .avatar-container:hover .hover-overlay{display:flex}user-profile .sidebar .user-info .avatar-container.disabled{cursor:default}user-profile .sidebar .user-info .avatar-container.disabled>.hover-overlay{display:none}user-profile .sidebar .user-info .avatar-container .hover-overlay{display:none;position:absolute;top:0;bottom:0;width:100%;height:100%;background-color:rgba(255,255,255,.502);justify-content:center;align-items:center;cursor:pointer}user-profile .sidebar .user-info .avatar-container .hover-overlay>mat-icon{width:34px;height:34px;color:var(--be-secondary-text)}user-profile .sidebar .user-info .avatar-container>img{width:100%;height:100%;-o-object-fit:cover;object-fit:cover}user-profile .sidebar .user-info>.names{margin-left:10px}user-profile .sidebar .user-info>.names>.name{font-size:1.5rem}user-profile .sidebar .user-info>.names>.email{color:var(--be-secondary-text)}user-profile .sidebar .user-details{margin-top:15px}user-profile .sidebar .user-details .details-row{display:flex;align-items:center;margin-bottom:15px}user-profile .sidebar .user-details .details-row .name{flex:0 0 30%;max-width:40px;margin-right:20px}user-profile .sidebar .user-details .details-row .value{flex:1 1 auto}user-profile .sidebar .user-details .details-row .value.input-container{height:auto}user-profile .sidebar .user-details .details-row .value.input-container>textarea{height:auto;padding:5px;border-radius:3px}user-profile .sidebar .user-details .emails .primary-email{font-weight:500}user-profile .sidebar .user-details .emails .secondary-email{margin-top:8px}user-profile .mat-tab-group{flex:1 1 auto;height:100%;border:1px solid var(--be-divider-default);min-width:0}user-profile .mat-tab-body-wrapper,user-profile .tickets,user-profile search-report-table{height:100%}user-profile search-report-table .material-panel{border:none}\n"],encapsulation:2}),t}(),tn=function(){var t=function(){function t(e,n,a){s(this,t),this.tickets=e,this.users=n,this.router=a}return l(t,[{key:"resolve",value:function(t,e){var n=this;return this.users.get(t.params.id,{with:["tags","purchase_codes","secondary_emails","details"]}).pipe((0,p.U)(function(t){if(t.user)return t.user;n.router.navigate(["/mailbox"])}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(h.LFG(Z.g),h.LFG(Qe.Q),h.LFG(u.F0))},t.\u0275prov=h.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),en=r(42690),nn=r(9141),an=r(82192),rn=r(48350),on=r(91241);function sn(t,e){if(1&t&&(h.TgZ(0,"div",26),h._uU(1),h.qZA()),2&t){var n=h.oxw().ngIf;h.xp6(1),h.Oqu(n.user_id)}}function cn(t,e){if(1&t&&(h.TgZ(0,"mat-option",27),h.TgZ(1,"div",28),h._UZ(2,"img",29),h.TgZ(3,"div",30),h.TgZ(4,"div",31),h._uU(5),h.qZA(),h.TgZ(6,"div",32),h._uU(7),h.qZA(),h.qZA(),h.qZA(),h.qZA()),2&t){var n=e.$implicit;h.Q6J("value",n),h.xp6(2),h.Q6J("src",n.avatar,h.LSH),h.xp6(3),h.Oqu(n.display_name),h.xp6(2),h.Oqu(n.email)}}function ln(t,e){if(1&t&&(h.TgZ(0,"div",33),h._uU(1),h.qZA()),2&t){var n=h.oxw().ngIf;h.xp6(1),h.Oqu(n.subject)}}function un(t,e){if(1&t&&(h.TgZ(0,"option",34),h._uU(1),h.qZA()),2&t){var n=e.$implicit;h.Q6J("ngValue",n.id),h.xp6(1),h.Oqu(n.display_name)}}function dn(t,e){if(1&t&&(h.TgZ(0,"div",35),h._uU(1),h.qZA()),2&t){var n=h.oxw().ngIf;h.xp6(1),h.Oqu(n.category)}}function pn(t,e){if(1&t&&(h.TgZ(0,"option",36),h._uU(1),h.qZA()),2&t){var n=e.$implicit;h.Q6J("ngValue",n.name),h.xp6(1),h.Oqu(n.display_name)}}function gn(t,e){if(1&t&&(h.TgZ(0,"div",37),h._uU(1),h.qZA()),2&t){var n=h.oxw().ngIf;h.xp6(1),h.Oqu(n.status)}}function hn(t,e){if(1&t&&(h.TgZ(0,"div",38),h._uU(1),h.qZA()),2&t){var n=h.oxw().ngIf;h.xp6(1),h.Oqu(n.body)}}function mn(t,e){if(1&t){var n=h.EpF();h.TgZ(0,"form",1),h.NdJ("ngSubmit",function(){return h.CHM(n),h.oxw().createTicket()}),h.TgZ(1,"div",2),h.TgZ(2,"label",3),h._uU(3,"Customer"),h.qZA(),h._UZ(4,"input",4),h.YNc(5,sn,2,1,"div",5),h.qZA(),h.TgZ(6,"mat-autocomplete",6,7),h.YNc(8,cn,8,4,"mat-option",8),h.ALo(9,"async"),h.qZA(),h.TgZ(10,"div",2),h.TgZ(11,"label",9),h._uU(12,"Subject"),h.qZA(),h._UZ(13,"input",10),h.YNc(14,ln,2,1,"div",11),h.qZA(),h.TgZ(15,"div",2),h.TgZ(16,"label",12),h._uU(17,"Category"),h.qZA(),h.TgZ(18,"select",13),h.YNc(19,un,2,2,"option",14),h.qZA(),h.YNc(20,dn,2,1,"div",15),h.qZA(),h.TgZ(21,"div",2),h.TgZ(22,"label",16),h._uU(23,"Status"),h.qZA(),h.TgZ(24,"select",17),h.YNc(25,pn,2,2,"option",18),h.qZA(),h.YNc(26,gn,2,1,"div",19),h.qZA(),h.TgZ(27,"div",20),h.TgZ(28,"label",21),h._uU(29,"Ticket Body"),h.qZA(),h.TgZ(30,"text-editor",22),h.NdJ("onFileUpload",function(t){return h.CHM(n),h.oxw().uploadFiles(t)})("onChange",function(t){return h.CHM(n),h.oxw().setBody(t)}),h.qZA(),h._UZ(31,"upload-progress-bar"),h.YNc(32,hn,2,1,"div",23),h.qZA(),h.TgZ(33,"reply-attachment-list",24),h.NdJ("detached",function(t){return h.CHM(n),h.oxw().removeAttachment(t)}),h.ALo(34,"async"),h.qZA(),h.TgZ(35,"button",25),h.ALo(36,"async"),h._uU(37,"Create"),h.qZA(),h.qZA()}if(2&t){var a=e.ngIf,i=h.MAs(7),r=h.oxw();h.Q6J("formGroup",r.ticketForm),h.xp6(4),h.Q6J("matAutocomplete",i),h.xp6(1),h.Q6J("ngIf",a.user_id),h.xp6(1),h.Q6J("displayWith",r.displayUserFn),h.xp6(2),h.Q6J("ngForOf",h.lcZ(9,14,r.users$)),h.xp6(6),h.Q6J("ngIf",a.subject),h.xp6(5),h.Q6J("ngForOf",r.ticketCategories),h.xp6(1),h.Q6J("ngIf",a.category),h.xp6(5),h.Q6J("ngForOf",r.mailboxTags.statusTags),h.xp6(1),h.Q6J("ngIf",a.status),h.xp6(4),h.Q6J("minHeight",230),h.xp6(2),h.Q6J("ngIf",a.body),h.xp6(1),h.Q6J("attachments",h.lcZ(34,16,r.attachments$)),h.xp6(2),h.Q6J("disabled",h.lcZ(36,18,r.loading$))}}var fn=function(){var e=function(){function e(t,n,a,i,r,o,c,l,u,d){s(this,e),this.fb=t,this.settings=n,this.uploadQueue=a,this.users=i,this.tickets=r,this.toast=o,this.router=c,this.route=l,this.mailboxTags=u,this.cd=d,this.errors$=new Be.X({}),this.attachments$=new Be.X([]),this.users$=new Be.X([]),this.loading$=new Be.X(!1),this.ticketCategories=[],this.ticketForm=this.fb.group({customer:[""],subject:[""],category:[""],body:[""],status:[""]})}return l(e,[{key:"ngOnInit",value:function(){var t=this;this.bindToCustomerControl(),this.mailboxTags.allTags$.pipe((0,Nt.h)(function(t){return!!t.length}),(0,$t.q)(1)).subscribe(function(){t.ticketForm.patchValue({status:t.mailboxTags.statusTags[0].name}),t.cd.markForCheck()}),this.route.data.subscribe(function(e){t.ticketCategories=e.categories,e.categories.length&&t.ticketForm.patchValue({category:t.ticketCategories[0].id})})}},{key:"createTicket",value:function(){var t=this;this.loading$.next(!0),this.tickets.create(this.getPayload()).pipe((0,w.x)(function(){return t.loading$.next(!1)})).subscribe(function(){t.toast.open("Ticket created"),t.mailboxTags.refresh(),t.router.navigateByUrl("/mailbox/tickets")},function(e){return t.errors$.next(e.errors)})}},{key:"getPayload",value:function(){var t=this.ticketForm.value;return t.user_id=t.customer.id,t.uploads=this.uploadQueue.getAllCompleted().map(function(t){return t.id}),t.created_by_agent=!0,t}},{key:"setBody",value:function(t){this.ticketForm.patchValue({body:t})}},{key:"uploadFiles",value:function(e){var n=this;this.uploadQueue.start(e).subscribe(function(e){n.attachments$.next([].concat(t(n.attachments$.value),[e.fileEntry]))})}},{key:"removeAttachment",value:function(t){for(var e=this.attachments$.value.slice(),n=0;n<e.length;n++)e[n].id===t.id&&e.splice(n,1);this.attachments$.next(e)}},{key:"bindToCustomerControl",value:function(){var t=this;this.ticketForm.get("customer").valueChanges.pipe((0,k.b)(250),(0,g.x)(),(0,_.w)(function(e){return t.searchUsers(e)}),(0,y.K)(function(){return(0,mt.of)([])})).subscribe(function(e){t.users$.next(e)})}},{key:"searchUsers",value:function(t){return t&&"string"==typeof t?this.users.getAll({query:t}):(0,mt.of)([])}},{key:"displayUserFn",value:function(t){return t?t.email:void 0}}]),e}();return e.\u0275fac=function(t){return new(t||e)(h.Y36(c.qu),h.Y36(Re.Z),h.Y36(nn.A),h.Y36(Qe.Q),h.Y36(Z.g),h.Y36(G.F),h.Y36(u.F0),h.Y36(u.gz),h.Y36(m.N),h.Y36(h.sBO))},e.\u0275cmp=h.Xpm({type:e,selectors:[["create-ticket"]],features:[h._Bn([Z.g,nn.A])],decls:2,vars:3,consts:[["class","many-inputs","ngNativeValidate","",3,"formGroup","ngSubmit",4,"ngIf"],["ngNativeValidate","",1,"many-inputs",3,"formGroup","ngSubmit"],[1,"input-container"],["for","user","trans",""],["type","text","id","user","formControlName","customer","required","",3,"matAutocomplete"],["class","error user-error",4,"ngIf"],[1,"create-ticket-user-autocomplete",3,"displayWith"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["for","subject","trans",""],["type","text","id","subject","formControlName","subject","required",""],["class","error subject-error",4,"ngIf"],["for","category-select","trans",""],["name","category","id","category-select","formControlName","category","required",""],[3,"ngValue",4,"ngFor","ngForOf"],["class","error category-error",4,"ngIf"],["for","status-select","trans",""],["name","status","id","status-select","formControlName","status","required",""],["class","status-tag-option",3,"ngValue",4,"ngFor","ngForOf"],["class","error status-error",4,"ngIf"],[1,"input-container","body-input-container"],["for","description","trans",""],["id","description","inlineUploadPrefix","ticket_images",3,"minHeight","onFileUpload","onChange"],["class","error body-error",4,"ngIf"],[3,"attachments","detached"],["mat-raised-button","","color","accent","type","submit","trans","",3,"disabled"],[1,"error","user-error"],[3,"value"],[1,"create-ticket-user-option"],[3,"src"],[1,"meta"],[1,"name"],[1,"email"],[1,"error","subject-error"],[3,"ngValue"],[1,"error","category-error"],[1,"status-tag-option",3,"ngValue"],[1,"error","status-error"],[1,"error","body-error"]],template:function(t,e){1&t&&(h.YNc(0,mn,38,20,"form",0),h.ALo(1,"async")),2&t&&h.Q6J("ngIf",h.lcZ(1,1,e.errors$))},directives:[o.O5,c.JL,c.sg,U.P,c.Fj,ft.ZL,c.JJ,c.u,c.Q7,ft.XC,o.sg,c.EJ,an.d,rn.o,on.G,vt.lW,xt.ey,c.YN,c.Kr],pipes:[o.Ov],styles:["create-ticket{display:block;padding:25px;overflow:auto;height:calc(100vh - 70px)}create-ticket form{max-width:800px}create-ticket .error{margin-top:7px;color:#f44336}create-ticket select,create-ticket option{text-transform:capitalize}.create-ticket-user-autocomplete .mat-option{height:auto;line-height:normal;line-height:initial}.create-ticket-user-option{display:flex;padding:8px 0}.create-ticket-user-option img{width:40px;height:40px;flex-shrink:0;margin-right:10px;border-radius:4px;overflow:hidden}.create-ticket-user-option .name{color:var(--be-text);font-size:1.5rem}.create-ticket-user-option .email{color:var(--be-secondary-text);font-size:1.4rem}\n"],encapsulation:2,changeDetection:0}),e}(),vn=r(19773),bn=r(59193),xn=r(99981),kn=function(){var t=function(){function t(e,n){s(this,t),this.router=e,this.http=n}return l(t,[{key:"resolve",value:function(t){var e=this;return this.http.get("new-ticket/categories").pipe((0,y.K)(function(){return e.router.navigateByUrl("/"),bn.E}),(0,vn.zg)(function(t){return(0,mt.of)(t.tags)}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(h.LFG(u.F0),h.LFG(xn.F))},t.\u0275prov=h.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t}(),_n=r(20765),yn=u.Bz.forChild([{path:"",canActivate:[en.a,_n.d],canActivateChild:[en.a,_n.d],data:{permissions:["tickets.view","tickets.create"]},children:[{path:"",redirectTo:"tickets",pathMatch:"full"},{path:"tickets/new",component:Ce,resolve:{categories:kn},data:{permissions:["tickets.create"]},children:[{path:"",component:fn}]},{path:"tickets",component:Ce,data:{permissions:["tickets.view"]},children:[{path:"",component:Ie},{path:":ticket_id",component:Me.S,resolve:{ticket:Ue.V}}]},{path:"users/:id",component:Ke,resolve:{user:tn},data:{permissions:["users.view","tickets.view","tags.view"]}}]}]),Zn=r(8574),wn=r(5259),Tn=r(18295),An=r(49866),Cn=r(95217),qn=r(13202),On=r(58193),In=function(){var t=function t(){s(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({imports:[[o.ez,On.x,An.N,u.Bz,xt.si,B.Cv,E.Hi]]}),t}(),Mn=r(66705),Un=r(16450),Fn=r(19807),Sn=r(6008),Qn=r(31330),Pn=r(87446),Jn=r(6253),Yn=function(){var t=function t(){s(this,t)};return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=h.oAB({type:t}),t.\u0275inj=h.cJS({providers:[Z.g,tn],imports:[[o.ez,c.u5,c.UX,u.Bz,Zn.m,wn.y,Tn.l,An.N,Cn.u,qn.R,Qn.X,In,Mn.z,Un.m,Fn.o,Sn.b,Pn.m,yn,F.Ps,vt.ot,K.AV,ft.Bb,tt.Tx,T.Is,fe,$e.Nh,Jn.B]]}),t}()},99051:function(t,e,n){n.d(e,{i:function(){return o}});var a,i=n(37716),r=n(90299),o=((a=function(){function t(e){s(this,t),this.http=e}return l(t,[{key:"index",value:function(e){return this.http.get(t.BASE_URI,e)}},{key:"create",value:function(e){return this.http.post(t.BASE_URI,e)}},{key:"update",value:function(e,n){return this.http.put("".concat(t.BASE_URI,"/").concat(e),n)}},{key:"delete",value:function(e){return this.http.delete("".concat(t.BASE_URI,"/").concat(e))}}]),t}()).BASE_URI="tags",a.\u0275fac=function(t){return new(t||a)(i.LFG(r.r))},a.\u0275prov=i.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a)}}])}();